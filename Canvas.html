<!DOCTYPE html>
<html>
<head>
<!-- Canvas.html -->
<title>Canvas</title>

<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

<link href="/resources/res/css/bootstrap.min.css" rel="stylesheet"
	type="text/css" />

<!-- Font Awesome Icons -->
<link
	href="https://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css"
	rel="stylesheet" type="text/css" />
<!-- Ionicons -->
<link
	href="https://code.ionicframework.com/ionicons/2.0.1/css/ionicons.min.css"
	rel="stylesheet" type="text/css" />
<script src="https://code.jquery.com/jquery-1.11.0.min.js"></script>

<script src="http://code.jquery.com/jquery-latest.js"></script>

<script
	src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
<script src="/socket.io/socket.io.js"></script>
<link href="/resources/res/css/site.css" rel="stylesheet" media="screen">
<link href="/resources/res/css/a.css" rel="stylesheet" media="screen">


<script type='text/javascript' src='/js/all_values.js'></script>
<script type='text/javascript' src='/js/db_all_values.js'></script>

<style>
.scrollbar {
	float: left;
	height: 100%;
	width: 100%;
	/* height: 300px;
	width: 65px; */
	background: #F5F5F5;
	overflow-y: scroll;
	margin-bottom: 25px;
}

.force-overflow {
	min-height: 40px;
	max-height: 250px;
	min-width: 320px;
}

#style-3::-webkit-scrollbar-track {
	-webkit-box-shadow: inset 0 0 6px rgba(0, 0, 0, 0.3);
	border-radius: 10px;
	background-color: #F5F5F5;
}

#style-3::-webkit-scrollbar {
	width: 12px;
	background-color: #F5F5F5;
}

#style-3::-webkit-scrollbar-thumb {
	border-radius: 10px;
	-webkit-box-shadow: inset 0 0 6px rgba(0, 0, 0, .3);
	background-color: #D62929;
}

.container_css {
	width: 1250px;
	height: 500px;
}

.chat_css {
	padding: 10px 0 0 0;
	float: right;
	width: 360px;
	/* height: 930px; */
	margin: 10px 10px 20px 0px;
}

.chatContent {
	height: 655px;
	background: #dbdfe2;
	border-right: 1px solid #d1d4d7;
}

.insert_css {
	border: 1px black;
	background-color: #3a3636;
	padding: 15px 15px 25px 15px;
}

.canvas_css {
	width: 1150px;
	margin: 20px 0px 10px 10px;
	height: 760px;
	float: left;
	background: white;
	padding: 0px;
	border-bottom: 1px solid black;
	border-right: 1px solid black;
}

.select_canvas {
	margin: 20px 10px 20px 20px;
	border: 1px solid #494949;
	background: white;
	border-radius: 5px;
	float: left;
}

.insertnick_input {
	width: 100px;
	margin: 0px 10px 10px 0px;
	border-radius: 5px;
}

.insert_css>span {
	color: white;
	margin: 5px;
	font-weight: 700;
}

.insertchat_css {
	border-radius: 5px;
	margin: 10px 0px 0px 0px;
}

div.mvc_css {
	border: solid 1px #eee;
	/* padding: 50 650 50 650; */
	background: #f8f8f8;
}

.chat_btn {
	margin: 7px 0px 0px 0px;
	height: 48px;
	float: right;
	border-radius: 5px;
	background-color: #0c0c0c;
	border-color: #585353;
}

.chat_btn:hover {
	background-color: #202020;
	border-color: #000000;
}

.add_person {
	margin: 10px 0px 0px 0px;
}

.button-position {
	margin-top: -20px;
	z-index: 5;
	/* height: 0; */
	float: right;
}
/* mvc select */
.mvc_select_main {
	background: #494949;
	color: white;
	padding: 10px 0px 10px 0px;
	text-align: center;
}

.mvc_select1 {
	margin: 20px 0px 20px 0px;
	width: 200px;
	border: 1px solid #8d8888;
}

.C_select {
	float: right;
	margin: 5px 61px 0px 0px;
}

.S_select {
	float: right;
	margin: 5px 61px 0px 0px;
}

.select_canvas2 {
	margin: 0px 0px 150px 0px;
}

.mvc_all {
	width: 314px;
	text-align: center;
	border-bottom: 1px solid #cfc7c7;
}

.controller_add {
	width: 314px;
	text-align: center;
	border-bottom: 1px solid #cfc7c7;
	padding: 5px 0px 5px 0px;
}

.dao_add {
	width: 314px;
	text-align: center;
	border-bottom: 1px solid #cfc7c7;
	padding: 5px 0px 5px 0px;
}

.vo_add {
	width: 314px;
	text-align: center;
	/*  	border-bottom: 1px solid #94c2e9;  */
	padding: 5px 0px 5px 0px;
}

.service_add {
	width: 314px;
	text-align: center;
	border-bottom: 1px solid #cfc7c7;
	padding: 5px 0px 5px 0px;
}

.select_main_add {
	margin: 0px 0px 10px 0px;
	/* padding-bottom: 10px; */
	height: 40px;
	border-bottom: 1px solid #6e6c6c;
}

.select_main_add>span {
	font-size: 18px;
	float: left;
	margin: 5px 0px 0px 30px;
}

#conlist>label {
	padding: 0px 0px 0px 30px;
	float: left;
}

div#conlist {
	width: 320px;
}

.fa-plus-square {
	cursor: pointer;
}
/* 친구 추가  */
button#divView {
	margin-top: -10px;
}

div#p_list {
	padding: 10px;
}

input.del {
	margin: 10px 0px 10px 10px;
}

input.mail_input {
	width: 200px;
}

/*채팅 입력  */
input#chatMessage {
	width: 270px;
	border-radius: 0px;
	margin-left: 5px;
}

.plus {
	width: 347px;
	height: 40px;
	/* border: none; */
}

div.p_list {
	height: 30px;
}

.D_select {
	float: right;
}

.P_select {
	float: right;
	margin-right: 190px;
}

.P_list_add {
	width: 90px;
	float: left;
	font-size: 16px;
	margin: 2px 0px 0px 10px;
}

form#maillist {
	margin: 0px 10px 10px 10px;
}

input#sendmail {
	margin: -5px 0px 5px 10px;
}

.oracle_list {
	margin: 20px 10px 20px 20px;
	border: 1px solid #494949;
	background: white;
	border-radius: 5px;
	float: left;
}

.Oracle_main {
	background: #494949;
	color: white;
	padding: 10px 0px 10px 0px;
	text-align: center;
}

.t_img {
	width: 90%;
	height: auto;
	position: relative;
	font-size: 12px;
	padding: 15px;
	border: 0px;
	box-shadow: 2px 2px 5px 0px #333;
}

.t_img:hover {
	cursor: pointer;
	opacity: 0.4;
	width: 100%;
	font-size: 12px;
	padding: 15px;
	border: 0px solid #4285f4;
}

.template {
	width: 1200px;
	height: 800px;
}

.t_table tr>td {
	position: relative;
	width: 500px;
	height: 400px;
}

#temp_t_img {
	position: absolute;
	width: 45%;
	height: auto;
	z-index: 2;
}

.big_img {
	border: 0px solid #333;
	/* box-shadow: 2px 2px 5px 0px #333; */
	box-shadow: rgba(0, 0, 0, 0.5) 0 0 0 9999px;
}

.big_img:hover {
	cursor: pointer;
}

.table_add {
	width: 314px;
	text-align: center;
	border-bottom: 1px solid #94c2e9;
	padding: 5px 0px 5px 0px;
}

.tabs {
	margin: 0;
	padding: 0;
	float: left;
	list-style: none;
	height: 32px;
	border-left: 1px solid #eee;
	width: 100%;
	font-family: 'dotum';
	font-size: 12px;
	margin-left: -1px;
}

.umlcreate {
	float: left;
	text-align: center;
	top: -15%;
	cursor: pointer;
	width: 82px;
	height: 31px;
	line-height: 31px;
	border: 1px solid black;
	font-weight: bold;
	background: white;
	overflow: hidden;
	position: relative;
	border-radius: 0px 0px 10px 10px;
	width: 180px;
	color: black;
	margin-top: -1px;
	border-top-color: white;
	border-left-color: black;
}

.umlcreate:hover {
	cursor: pointer;
	background: #bbb;
}

.dbcreate:hover {
	cursor: pointer;
	background: #bbb;
}

.dbcreate {
	float: left;
	text-align: center;
	cursor: pointer;
	top: -15%;
	width: 82px;
	height: 31px;
	line-height: 31px;
	border: 0px solid black;
	border-left: none;
	font-weight: bold;
	background: #333;
	overflow: hidden;
	position: relative;
	border-radius: 0px 0px 10px 10px;
	width: 180px;
	color: white;
	margin-top: -1px;
}
</style>

<script>
	$(document)
			.ready(
					function() {

						//참여자 목록을 보여주는 리스트 숨김
						$('#p_list').hide();
						//보이기 버튼을 클릭 했을 시에 참여자 목록을 보여주거나 숨겨준다.
						$('#divView').click(function() {
							var state = $('#p_list').css('display');
							//숨겨진 상태
							if (state == 'none') {
								//0.5초 의 지연으로 보여짐.
								$('#p_list').show(500);

							}
							//보여지는 상태
							else {
								//0.5초의 지연으로 사라짐
								$('#p_list').hide(500);
							}

						});

						// /temp?id=""&room="" 정보를 받아와서 ejs특수태그를 이용해 받아옴.
						var id = '<%= userid %>';
						//채팅자 이름에 집어넣음

						document.getElementById("chatName").value = id;

						//룸 이름에 집어넣음
						var roomname = '<%= room %>';
						document.getElementById("room").value = roomname;

						var socket = io.connect(); // 소켓 이벤트를 연결

						/**
							참여자 목록 영역
						 */
						var participant = [];

						var check;

						//참여자 목록을 서버에 요청함
						socket.emit('participant');

						socket.on('completepj', function() {
							alert('압축완성');
							//test5:주석풀음
							socket.emit('deletefile');
							window.location = '/download/';

						});
						/* test5 : sql문 다운로드 추가 */
						socket.on('downloadsql', function() {
		                     window.location ='/downloadsql/';
		                  })
						//참여자 목록을 받아옴
						socket.on('participant', function(data) {
							//참여자 목록을 저장시킨 후
							participant = data;
							//참여자목록 div에 뿌려줌
							$('#participant').text(participant.toString());
						});

						//참여자가 룸을 나갈 시
						socket.on('exitclient', function(data) {
							//참여자 목록 배열을 새로 받아서 넣어줌
							participant = data;
							$('#participant').text(participant.toString());
						});

						/**
						채팅 영역
					 */
					socket
							.on(
									'chatMessage',
									function(data) {

										//자신의 이름 체크
										var me = $('#chatName').val();
										if (me === data.name) {
											//이름이 같을 때는 오른쪽에 메세지가 뜨게 한다.
											var output = '';
											output += '<div align="right">'
													+ '<div style="font-weight:900; margin-right: 5px;">'
													+ data.name + '님의 말:'
													+ '</div>';
											output += '	<p align="left" style="background: yellow; width: 200px; color: black; border-radius:3px; padding: 8px; margin-right: 5px;box-shadow: 0px 2px gray">	'
													+ data.message
													+ '</p></div>';
										} else {
											//이름이 다를 경우 메세지가 오른쪽에 뜨게 한다.
											var output = '';
											output += '<div align="left" style="padding-left:10px">'
													+ '<div style="font-weight:900;">'
													+ data.name
													+ '님의 말:'
													+ '</div>';
											output += '<p align="left" style="background:white; width:200px; color: black; border-radius:3px; padding: 8px; box-shadow: 0px 2px gray">		'
													+ data.message
													+ '</p></div>';
										}
										//내용 추가
										$(output).appendTo('#chatContent');
										//스크롤이 내려가도 가장 마지막 값이 뷰에 보이게 해준다.
										$('.chatContent')
												.scrollTop(
														$('.chatContent')[0].scrollHeight);
									});

						 

						 

						//엔터키 입력 시
						$('#chatMessage').keydown(function(event) {
							if (event.which === 13) {
								var checkEmpty = $('#chatMessage').val();
								//아무것도 입력하지 않았을 경우에는 메세지가 입력되지 않는다.
								if (checkEmpty != "") {
									//이름이랑 메시지 보냄
									socket.emit('chatMessage', {
										name : $('#chatName').val(),
										message : $('#chatMessage').val()
									});
									//채팅창에 입력한 내용 없앰.
									$('#chatMessage').val("");
								}
							}

						});

						//메일 삭제 영역 입력하기
						$(document).on("click", ".del", function() {
							$(this).parent().remove();
							mailListValue--;

						});

						//메일 추가 영역
						$('#addmail')
								.click(
										function() {
											var mailListDiv = $('#maillist')
													.val();

											var output = '';
											output += '<div>';
											//name을 모두 mail로 지정시킨다.
											output += '<input type="text" name="mail" class="mail_input"/>';
											output += '<input type="button" value="삭제" class="del" name="del"/>';
											output += '<br/>';
											output += '</div>';

											$(output).appendTo('#maillist');
											mailListValue++;

										});

						//메일 보내기 영역
						$('#sendmail').click(
								function() {

									var sendList = [];
									for (var i = 0; i < mailListValue; i++) {
										//추가시킨 메일 의 name을 모두 mail로 만들어서 추가된 메일칸의  모든 요소를 저장시킨다.
										var mail = $(
												"#maillist input[name='mail']")
												.eq(i).val();

										//저장된 메일을 배열에 추가시킨다.
										sendList[i] = mail;
									}
									//서버에 룸 정보와 보낼 메일 리스트를 보낸다.
									socket.emit('sendEmail', {
										room : roomname,
										mail : sendList
									});
								});

						//메일 추가를 위한 변수 지정
						var mailListValue = 0;

						//버튼 클릭 시
						$('#chatButton').click(function() {
							var checkEmpty = $('#chatMessage').val();
							if (checkEmpty != "") {

								socket.emit('chatMessage', {
									name : $('#chatName').val(),
									message : $('#chatMessage').val()
								});
								$('#chatMessage').val("");
							}
						});

					});
</script>



<script>
    
    $(document).ready(function(){
		$('li').on('click', function(){

			var dbtn = $(this).attr("rel");
			if(dbtn=='oraclego'){
				$('')
				$('.select_canvas').hide();
				$('.oracle_list').show();
				$('#canvas1').hide();
				$('#canvas2').fadeIn();
			}else if(dbtn=='umlgo'){

				$('.select_canvas').show();
				$('.oracle_list').hide();
				$('#canvas1').fadeIn();
				$('#canvas2').hide();
			}
			
			
		});
		
		$('.li').click(function(){
			if($(this).css("color")=="rgb(255, 255, 255)"){
				$(this).css('border','1px solid black');
				$(this).css('background','white');
				$(this).css('color','black');
				$(".li").not(this).css('border','0px solid black');
				$(".li").not(this).css('background','#333');
				$(".li").not(this).css('color','white');
			}
		});
	});
    
</script>


<div class="w3-top">
	<ul class="w3-navbar w3-theme-d2 w3-left-align w3-large">
		<li><a href="http://localhost:8081"
			class="w3-teal  w3-middle-home"><img
				src="/resources/res/images/i.png" width="40" height="40"
				class="logo_think">THINKPATTERN</a></li>
		<li class="w3-hide-medium w3-hide-large w3-mright"><a
			class="w3-hover-white w3-large w3-theme-d2 w3-middle"
			href="javascript:void(0);" onclick="openNav()"><i
				class="fa fa-bars"></i></a></li>

		<div class="middle">
			<li class="w3-hide-small w3-middle"><a
				href="http://localhost:8081">MANUAL</a></li>
			<li class="w3-hide-small w3-middle"><a
				href="http://localhost:8081/pattern/list">DESIGN PATTERN</a></li>
			<li class="w3-hide-small w3-middle"><a
				href="http://localhost:8081/notice/list">SERVICE CENTER</a></li>
		</div>

		<div class="log_m">
			<span><%= userid %>님 환영합니다.</span>
			<li class="w3-hide-small w3-right"><a href="/user/modifyConfirm"
				class="button small"><i class="fa fa-user" aria-hidden="true"></i>
					modify</a></li>
			<li class="w3-hide-small w3-right"><a href="/user/logout"
				class="button small"><i class="fa fa-sign-out"
					aria-hidden="true"></i> logout</a></li>
		</div>


	</ul>
</div>

<!-- Navbar on small screens -->
<div id="navDemo" class="w3-hide w3-hide-large w3-hide-medium w3-top"
	style="margin-top: 43px;">
	<ul class="w3-navbar w3-left-align w3-large w3-theme">
		<li class="w3-middle"><a href="../">MANUAL</a></li>
		<li class="w3-middle"><a href="http://localhost:8210/?id=aaa">DESIGN
				PATTERN</a></li>
		<li class="w3-middle"><a href="http://localhost:8081/notice/list">SERVICE
				CENTER</a></li>

		<div class="log_in">
			<li><span id="chatName2"></span> <a href="/user/modifyConfirm"
				class="button small smenu"><i class="fa fa-user"
					aria-hidden="true"></i> modify</a> <a href="/user/logout "
				class="button small smenu"><i class="fa fa-sign-out"
					aria-hidden="true"></i> logout</a></li>
		</div>

	</ul>
</div>


</head>
<body>
	<div id="main" class="wrapper style1">
		<div class="container">
			<div class="mvc_css">
				<div class="row">
					<div class="col-md-2 select_canvas">
						<div class="mvc_select_main">Select Pattern</div>
						<div class="mvc_all">
							<button type="button" class="btn btn-primary mvc_select1"
								id="crea_mvc">MVC 구조 그리기</button>
						</div>
						<div class="select_canvas2">


							<div class="controller_add">
								<div class="select_main_add">
									<span>Controller</span> <i
										class="fa fa-plus-square fa-2x C_select" id="crea_controller"
										aria-hidden="true"></i>
								</div>
								<div id="conlist"></div>

							</div>
							<div class="service_add">
								<div class="select_main_add">
									<span>Service</span> <i
										class="fa fa-plus-square fa-2x S_select" id="crea_service"
										aria-hidden="true"></i>
								</div>

								<div id="serlist"></div>
							</div>
							<div class="dao_add">
								<div class="select_main_add">
									<span>DAO</span> <i class="fa fa-plus-square fa-2x C_select"
										id="crea_dao" aria-hidden="true"></i>
								</div>

								<div id="daolist"></div>
							</div>
							<div class="vo_add">
								<div class="select_main_add">
									<span>VO</span> <i class="fa fa-plus-square fa-2x C_select"
										id="crea_vo" aria-hidden="true"></i>
								</div>

								<div id="volist"></div>
							</div>
						
						</div>
							<!--**수정-->
							<div>
								<button type="button" class="btn btn-secondary"
									id="connect_button">연결</button>
							
							</div>
					</div>
					<!-- oracle 왼쪽 메뉴 -->
			<div class="col-md-2 oracle_list" style="display: none">
						<div class="Oracle_main">Oracle Table</div>
						<div class="controller_add">
							<div class="select_main_add">
								<span> Table</span> <i class="fa fa-plus-square fa-2x C_select"
									id="crea_table" aria-hidden="true"></i>

							</div>
							<div id="tablelist"></div>
						</div>
					</div>
					<div class="col-md-7 canvas_css">
					<!-- test5 : 민섭 -->
					
					<!-- 
					<div style="float:left; width:1600px; overflow:hidden;">
      <canvas id="canvas1" height="900" width="5000" style= "position: absolute;">This browser doesn't support canvas</canvas>
					 -->
					
					
					
					<!-- <div style="float:left; width:5000; overflow:hidden;">
      				<canvas id="canvas1" height="900" width="1150" style= "position: absolute;"></canvas>
      				<canvas id="canvas2" height="900" width="1150" style= "position: absolute; display: none"></canvas> -->
					<canvas id="canvas1" height="760" width="1150"></canvas>
						<canvas id="canvas2" height="760" width="1150"
							style="display: none"></canvas>

						<!-- 탭 메뉴 -->
										<ul class="tabs">
							<li class="umlcreate li" rel="umlgo">UML 생성</li>
							<li class="dbcreate li" rel="oraclego">DB 생성</li>
						</ul>

						<div class="button-position">
							<button type="button" class="btn btn-primary"
								id="select_template">템플릿 선택</button>
							<button type="button" class="btn btn-secondary"
								id="connect_oralce">Oracle</button>
							<button class="btn btn-info create_sql">sql문 생성</button>
							<button class="btn btn-info create_file">파일 생성</button>

						</div>


						<!-- Modal -->
						<div class="modal fade" id="myModal" tabindex="-1" role="dialog"
							aria-labelledby="myModalLabel" aria-hidden="true">
							<div class="modal-dialog">
								<div class="modal-content">
									<div class="modal-header">
										<button type="button" class="close" data-dismiss="modal"
											aria-label="Close">
											<span aria-hidden="true">&times;</span>
										</button>
										<h3 class="modal-title" id="myModalLabel">Class Add</h3>
									</div>
									<div class="modal-body">
										<!-- modal의 body 여기안에 input box들을 넣음. -->

										Class Name : <input type="text" id="classname" />
										<div id="valueDiv">
											<br /> <input type="Button" value="Value추가"
												onclick="AddValueForm()"> <input type="Button"
												value="Value삭제" onclick="DelValueForm()"> <br />
											Value0 : <input type="text" id="valuename0" class="valuename"/> <select
												id="select_value0" class="select_value">

											</select> <input type="hidden" id="direct_input_val0"> <br />
										</div>
										<br />
										<div id="methodDiv">
											<input type="Button" value="Method추가"
												onclick="AddMethodForm()"> <input type="Button"
												value="Method삭제" onclick="DelMethodForm()"> <br />
											Method0 : <input type="text" id="methodname0" class="methodname"/> <select
												id="select_method0" class="select_method">

											</select> <input type="hidden" id="direct_input_func0"> <br />
										</div>
										<br /> Connet Class : <select id="connectclass">
											<option value="init">--선택하세요--</option>
										</select><br />
									</div>
									<div class="modal-footer">
										<button type="button" class="btn btn-primary" onclick="OnOK()"
											data-dismiss="modal">Save</button>
										<button type="button" class="btn btn-default"
											onclick="OnCancel()" data-dismiss="modal">Close</button>
									</div>
								</div>
							</div>
						</div>
						<!-- VO 전용 Modal -->
						<div class="modal fade" id="voModal" tabindex="-1" role="dialog"
							aria-labelledby="myModalLabel" aria-hidden="true">
							<div class="modal-dialog">
								<div class="modal-content">
									<div class="modal-header">
										<button type="button" class="close" data-dismiss="modal"
											aria-label="Close">
											<span aria-hidden="true">&times;</span>
										</button>
										<h4 class="modal-title" id="myModalLabel">Modal title</h4>
									</div>
									<div class="modal-body">
										<!-- modal의 body 여기안에 input box들을 넣음. -->

										Class Name : <input type="text" id="voname" />
										<div id="voDiv">
											<br /> <input type="Button" value="Value추가"
												onclick="AddVOForm()"> <input type="Button"
												value="Value삭제" onclick="DelVOForm()"> <br />
											Value0 : <input type="text" id="vo_valname0" /> <select
												id="select_voval0">

												<option value="int">int</option>
												<option value="String">String</option>
											</select> <br />
										</div>
									</div>
									<div class="modal-footer">
										<button type="button" class="btn btn-primary" onclick="VOOK()"
											data-dismiss="modal">Save</button>
										<button type="button" class="btn btn-default"
											onclick="OnCancel()" data-dismiss="modal">Close</button>
									</div>
								</div>
							</div>
						</div>

						<!-- DB 전용 Modal -->
						<div class="modal fade" id="dbModal" tabindex="-1" role="dialog"
							aria-labelledby="myModalLabel" aria-hidden="true">
							<div class="modal-dialog">
								<div class="modal-content">
									<div class="modal-header">
										<button type="button" class="close" data-dismiss="modal"
											aria-label="Close">
											<span aria-hidden="true">&times;</span>
										</button>
										<h4 class="modal-title" id="myModalLabel">Modal title</h4>
									</div>
									<div class="modal-body">
										<!-- modal의 body 여기안에 input box들을 넣음. -->

										ID : <input type="text" id="dbid" /><br /> PW : <input
											type="text" id="dbpw" /><br /> PORT : <input type="text"
											id="dbport" /><br /> SID : <input type="text" id="dbsid" /><br />
									</div>
									<div class="modal-footer">
										<button type="button" class="btn btn-primary" onclick="DBOK()"
											data-dismiss="modal">Save</button>
										<button type="button" class="btn btn-default"
											onclick="OnCancel()" data-dismiss="modal">Close</button>
									</div>
								</div>
							</div>
						</div>
						<!-- 오라클 modal 추가 -->
						<!-- DB 전용 Modal -->
						<div class="modal fade" id="tableModal" tabindex="-1"
							role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
							<div class="modal-dialog">
								<div class="modal-content">
									<div class="modal-header">
										<button type="button" class="close" data-dismiss="modal"
											aria-label="Close">
											<span aria-hidden="true">&times;</span>
										</button>
										<h4 class="modal-title" id="myModalLabel">Modal title</h4>
									</div>
									<div class="modal-body">
										<!-- modal의 body 여기안에 input box들을 넣음. -->

										Table Name : <input type="text" id="tablename" />
										<div id="tableDiv">
											<br /> <input type="Button" value="Value추가"
												onclick="AddColumnForm()"> <input type="Button"
												value="Value삭제" onclick="DelColumnForm()"> <br />
											Column0 :<input type="text" id="column_name0" class="column_name"/> <select
												id="select_datatype0" class="select_datatype">
												<option value="NUMBER">NUMBER</option>
												<option value="VARCHAR2">VARCHAR2</option>
												<option value="직접입력">직접입력</option>
											</select> <input type="hidden" id="direct_column0"> <br />
										</div>
										<div>
											DAO : <select id="connect_dao">

											</select>
										</div>
										<br />
										<!-- Connet Table : 
               <select id="connecttable"> 
                  
               </select> -->
										<br />
									</div>
									<div class="modal-footer">
										<button type="button" class="btn btn-primary"
											onclick="TableOK()" data-dismiss="modal">Save</button>
										<button type="button" class="btn btn-default"
											onclick="DBCancel()" data-dismiss="modal">Close</button>
									</div>
								</div>

							</div>
						</div>

						<!-- 템플릿 선택 모달 -->
						<div class="modal fade" id="template" tabindex="-1" role="dialog"
							aria-labelledby="myModalLabel" aria-hidden="true">
							<div class="modal-dialog template">
								<div class="modal-content">
									<div class="modal-header">
										<button type="button" class="close" data-dismiss="modal"
											aria-label="Close">
											<span aria-hidden="true">&times;</span>
										</button>
										<h4 class="modal-title" id="myModalLabel">템플릿을 선택해주세요</h4>
									</div>
									<div class="modal-body">
										<!-- modal의 body 여기안에 input box들을 넣음. -->
										<table class="t_table" style="border-collapse: inherit;">
											<div id="temp_t_img"></div>
											<tr>
												<td><img class="t_img"
													src="/resources/res/images/1.PNG" alt="1" /></td>
												<td><img class="t_img"
													src="/resources/res/images/2.PNG" alt="2" /></td>
											</tr>
											<tr>
												<td><img class="t_img"
													src="/resources/res/images/3.PNG" alt="3" /></td>
												<td><img class="t_img"
													src="/resources/res/images/4.PNG" alt="4" /></td>
											</tr>
										</table>
									</div>
									<div class="modal-footer"><!-- test5 -->
										<button type="button" class="btn btn-primary"
											onclick="Select_img()" data-dismiss="modal">Save</button>
										<button type="button" class="btn btn-default"
											onclick="template_cancel()" data-dismiss="modal">Close</button>
									</div>
								</div>
							</div>
						</div>

					</div>


					<div class="col-md-3 chat_css ">

						<table border="1px">

							<div class="chatContent scrollbar" id="style-3">
								<div value="친구추가" id="divView" class="btn btn-primary plus">
									<i class="fa fa-bars fa-2x D_select" aria-hidden="true"></i>
								</div>


								<div id="p_list" class="btn-primary">
									<div class="p_list">
										<div class="P_list_add">참여자 목록</div>
										<i class="fa fa-plus-square fa-2x P_select" aria-hidden="true"
											id="addmail"></i>
										<div id="participant"
											style="margin-bottom: 20px; margin-left: 20px"></div>
									</div>
									<br />


									<form id="maillist" name="maillist"></form>

									<input type="button" value="메일 보내기  " id="sendmail" />

								</div>
								<div id="chatContent" class="force-overflow"></div>
							</div>



							<div class="insert_css">
								<span>아이디 : </span> <input id="chatName" value=""
									readonly="readonly" class="insertnick_input" /> <span>방
									:</span> <input id="room" value="" readonly class="insertnick_input" />
								<span>메시지 입력 :</span><input id="chatMessage" type="text"
									class="insertchat_css" />

								<button id="chatButton" class="btn btn-primary chat_btn">입력</button>
							</div>


						</table>
					</div>

				</div>



			</div>
		</div>
	</div>
</body>
<footer id="footer" style="margin: 0 auto; padding: 23px 0 22px 0">

	<a href="http://www.skhu.ac.kr"></a>

	<div class="skhu">152-716 서울시 구로구 연동로 320 / 지하철 1,7호선
		온수역(성공회대입구역) T.02-2610-4114 F.02-2683-8858</div>

	<ul class="copyright">COPYRIGHTⓒ SUNGKONGHOE UNIVERSITY. ALL
		RIGHTS RESERVED.
	</ul>

</footer>
</html>


<script>
        var canvas = document.getElementById('canvas1');     // Canvas 객체 추출

        var context = canvas.getContext('2d');
        function canvasX(clientX) {
            var bound = canvas.getBoundingClientRect();
            return (clientX - bound.left) * (canvas.width / bound.width);
        }

        function canvasY(clientY) {
            var bound = canvas.getBoundingClientRect();
            return (clientY - bound.top) * (canvas.height / bound.height);
        }
     // Point 생성자 함수 선언
    function Point(event, target) { 
         this.x = canvasX(event.clientX); //- $(target).position().left ;
    	
   
// 파폭은 offsetX 속성을 지원하지 않으므로 이런 방식의 코드를 사용함
// list를 위한 div를 만들면 그만큼 x좌표가 밀려서 출력되기 때문에 div의 크기만큼 뺴줌.

        this.y = canvasY(event.clientY);

    }

    </script>


<script>



        var socket = io.connect();      // 소켓 이벤트를 연결

        socket.emit('join', '<%= room %>');     // ejs 모듈 특수 태그 사용. http://localhost:8210/canvas/21 접속시 문자열 21 전송


		list_click=false;

		//mvc_modal.js
//리스트에서 클릭한 거 check_package에 넣어주기
		$("#crea_controller").click(function(){
			list_click = true;
			check_package = "Controller";
		});
		$("#crea_service").click(function(){
			list_click = true;
			check_package = "Service";
		});
		$("#crea_dao").click(function(){
			list_click = true;
			check_package = "DAO";
		});
		$("#crea_mvc").click(function(){
			list_click = true;
			check_package = "mvc";
		});
		$("#crea_vo").click(function(){
			$("#voModal").modal();
		});
		$("#connect_oralce").click(function(){
			document.getElementById("dbid").value=db.dbid; 
			document.getElementById("dbpw").value=db.dbpw; 
			document.getElementById("dbport").value=db.dbport; 
			document.getElementById("dbsid").value=db.dbsid; 
			$("#dbModal").modal();
		});
		$("#connect_button").click(function(){
		connect_btncheck = true;
		
	})

        





		//dinamic_form.js

/**
 * value form을 하나하나 증가시켜주는 함수
 */
 /* test6 : 민섭's 수정 */
function AddValueForm() {
   var addedValFormDiv = document.getElementById("valueDiv");
   var str = "Value";
   str += val_count + ":" + "<input type='text' id='valuename" + val_count + "' class='valuename'><select id = 'select_value"+ select_valcnt +"' class='select_value'>"
                  + "<option value='int'>int</option> <option value='String'>String</option></select>"
                  + "<input type='hidden' id='direct_input_val" + dival_cnt + "'></input>";
   // 추가할 폼(에 들어갈 HTML)
   var addedValDiv = document.createElement("div"); // 폼 생성
   addedValDiv.id = "added_value" + val_count; // 폼 Div에 ID 부여 (삭제를 위해)
   addedValDiv.innerHTML = str; // 폼 Div안에 HTML삽입
   addedValFormDiv.appendChild(addedValDiv); // 삽입할 DIV에 생성한 폼 삽입
   
   for(var i=0; i<voList.length; i++){
      $('<option value="'+ voList[i].vo_name +'">' + voList[i].vo_name + '</option>').appendTo('#select_value' + select_valcnt);
   }
   
   $('<option value="직접입력">직접입력</option>').appendTo('#select_value' + select_valcnt);
   
   var temp_val_string = document.getElementById("select_value0").value;
   var temp_func_string = document.getElementById("select_method0").value;
   var temp_conn_string = document.getElementById("connectclass").value;
   
   val_count++;
   select_valcnt++;
   dival_cnt++;
   Dynamic_Connect_List();
   
   document.getElementById("select_value0").value = temp_val_string;
   document.getElementById("select_method0").value = temp_func_string;
   document.getElementById("connectclass").value = temp_conn_string;
}

/**
 * value form을 하나 감소시켜주는 함수
 */
function DelValueForm() {
	var addedValFormDiv = document.getElementById("valueDiv");
	
	if (val_count > 1) { // 현재 폼이 두개 이상이면
		var addedValDiv = document.getElementById("added_value" + (--val_count));
		--select_valcnt;
		--dival_cnt;
		// 마지막으로 생성된 폼의 ID를 통해 Div객체를 가져옴
		addedValFormDiv.removeChild(addedValDiv); // 폼 삭제 
	}
}

/**
 * value form을 하나빼고 모두 제거 하는 함수
 */
function DelValueAllForm()
{
	var addedValFormDiv = document.getElementById("valueDiv");
	while(val_count > 1)
	{
		if (val_count > 1) { // 현재 폼이 두개 이상이면
		var addedValDiv = document.getElementById("added_value" + (--val_count));
		--select_valcnt;
		--dival_cnt;
		// 마지막으로 생성된 폼의 ID를 통해 Div객체를 가져옴
		addedValFormDiv.removeChild(addedValDiv); // 폼 삭제 
		} 
	}
}

/**
 * method form을 하나하나 증가시켜주는 함수
 */
 /* test6 : 민섭수정 */
function AddMethodForm() {
    var addedMFormDiv = document.getElementById("methodDiv");
    var str = "Method";
    str += m_count + ":" + "<input type='text' id='methodname" + m_count + "' class='methodname'><select id = 'select_method"+ select_mcnt +"' class='select_method'>"
                   + "<option value='void'>void</option> <option value='int'>int</option> <option value='String'>String</option></select>"
                   + "<input type='hidden' id='direct_input_func" + difunc_cnt + "'></input>";
    // 추가할 폼(에 들어갈 HTML)
    var addedMDiv = document.createElement("div"); // 폼 생성
    addedMDiv.id = "added_method" + m_count; // 폼 Div에 ID 부여 (삭제를 위해)
    addedMDiv.innerHTML = str; // 폼 Div안에 HTML삽입
    addedMFormDiv.appendChild(addedMDiv); // 삽입할 DIV에 생성한 폼 삽입
    
    for(var i=0; i<voList.length; i++){
       $('<option value="'+ voList[i].vo_name +'">' + voList[i].vo_name + '</option>').appendTo('#select_method' + select_mcnt);
    }
    
    $('<option value="직접입력">직접입력</option>').appendTo('#select_method' + select_mcnt);
    
    var temp_val_string = document.getElementById("select_value0").value;
    var temp_func_string = document.getElementById("select_method0").value;
    var temp_conn_string = document.getElementById("connectclass").value;
    
    m_count++;
    select_mcnt++;
    difunc_cnt++;
    Dynamic_Connect_List();

    document.getElementById("select_value0").value = temp_val_string;
    document.getElementById("select_method0").value = temp_func_string;
    document.getElementById("connectclass").value = temp_conn_string;
 }

/**
 * method form을 하나하나 삭제시켜주는 함수
 */
function DelMethodForm() {
	var addedMFormDiv = document.getElementById("methodDiv");
	if (m_count > 1) { // 현재 폼이 두개 이상이면
		var addedMDiv = document.getElementById("added_method" + (--m_count));
		--select_mcnt;
		--difunc_cnt;
		// 마지막으로 생성된 폼의 ID를 통해 Div객체를 가져옴
		addedMFormDiv.removeChild(addedMDiv); // 폼 삭제 
	}
}

/**
 * method form을 하나를 제외하고 모두 삭제시켜주는 함수
 */
function DelMethodAllForm()
{
	var addedMFormDiv = document.getElementById("methodDiv");
	while(m_count > 1)
	{
		if (m_count > 1) { // 현재 폼이 두개 이상이면
			var addedMDiv = document.getElementById("added_method" + (--m_count));
			--select_mcnt;
			--difunc_cnt;
			// 마지막으로 생성된 폼의 ID를 통해 Div객체를 가져옴
			addedMFormDiv.removeChild(addedMDiv); // 폼 삭제 
		}
	}
}

/**
 * value form을 하나하나 증가시켜주는 함수(vo)
 */
function AddVOForm() {
	var addedVOFormDiv = document.getElementById("voDiv");
	var str = "Value";
	str += vo_valcount + ":" + "<input type='text' id='vo_valname" + vo_valcount + "'><select id = 'select_voval"+ select_vocnt +"'>"
						+ "<option value='int'>int</option> <option value='String'>String</option></select>";
	// 추가할 폼(에 들어갈 HTML)
	var addedVODiv = document.createElement("div"); // 폼 생성
	addedVODiv.id = "added_vo" + vo_valcount; // 폼 Div에 ID 부여 (삭제를 위해)
	addedVODiv.innerHTML = str; // 폼 Div안에 HTML삽입
	addedVOFormDiv.appendChild(addedVODiv); // 삽입할 DIV에 생성한 폼 삽입
	vo_valcount++;
	select_vocnt++;
}

/**
 * value form을 하나 감소시켜주는 함수
 */
function DelVOForm() {
	var addedVOFormDiv = document.getElementById("voDiv");
	
	if (vo_valcount > 1) { // 현재 폼이 두개 이상이면
		var addedVODiv = document.getElementById("added_vo" + (--vo_valcount));
		--select_vocnt;
		// 마지막으로 생성된 폼의 ID를 통해 Div객체를 가져옴
		addedVOFormDiv.removeChild(addedVODiv); // 폼 삭제 
	}
}

/**
 * value form을 하나빼고 모두 제거 하는 함수
 */
function DelVOAllForm()
{
	var addedVOFormDiv = document.getElementById("voDiv");
	while(vo_valcount > 1)
	{
		if (vo_valcount > 1) { // 현재 폼이 두개 이상이면
		var addedVODiv = document.getElementById("added_vo" + (--vo_valcount));
		--select_vocnt;
		// 마지막으로 생성된 폼의 ID를 통해 Div객체를 가져옴
		addedVOFormDiv.removeChild(addedVODiv); // 폼 삭제 
		} 
	}
}

/**
 * 동적으로 connectclass에 list를 받아와 option으로 만들어주는 code
 * modal창이 띄워지기 전에 호출해야함.
 */
function Dynamic_Connect_List(){
	
	// connectclass의 form을 초기화함.
	$('#connectclass').empty();
	$('<option value="init">--선택하세요--</option>').appendTo('#connectclass');
	$('#select_value0').empty();
	$('<option value="int">int</option>').appendTo('#select_value0');
	$('<option value="String">String</option>').appendTo('#select_value0');
	$('#select_method0').empty();
	$('<option value="void">void</option>').appendTo('#select_method0');
	$('<option value="int">int</option>').appendTo('#select_method0');
	$('<option value="String">String</option>').appendTo('#select_method0');
	
	for(var i=0; i<voList.length; i++){
		$('<option value="'+ voList[i].vo_name +'">' + voList[i].vo_name + '</option>').appendTo('#select_value0');
	}
	
	for(var i=0; i<voList.length; i++){
		$('<option value="'+ voList[i].vo_name +'">' + voList[i].vo_name + '</option>').appendTo('#select_method0');
	}

	$('<option value="직접입력">직접입력</option>').appendTo('#select_value0');
	$('<option value="직접입력">직접입력</option>').appendTo('#select_method0');
	
	if(check_package == "Controller"){
		
		for(var i=0; i<serviceList.length; i++){
			$('<option value="'+ serviceList[i].classname +'">' + serviceList[i].classname + '</option>').appendTo('#connectclass');
		}
		
		for(var i=0; i<daoList.length; i++){
			$('<option value="'+ daoList[i].classname +'">' + daoList[i].classname + '</option>').appendTo('#connectclass');
		}
				
	}else if(check_package == "Service"){
		
		for(var i=0; i<controllerList.length; i++){
			$('<option value="'+ controllerList[i].classname +'">' + controllerList[i].classname + '</option>').appendTo('#connectclass');
		}
		
		for(var i=0; i<daoList.length; i++){
			$('<option value="'+ daoList[i].classname +'">' + daoList[i].classname + '</option>').appendTo('#connectclass');
		}
		
	}else if(check_package == "DAO"){
		
		for(var i=0; i<controllerList.length; i++){
			$('<option value="'+ controllerList[i].classname +'">' + controllerList[i].classname + '</option>').appendTo('#connectclass');
		}
		
		for(var i=0; i<serviceList.length; i++){
			$('<option value="'+ serviceList[i].classname +'">' + serviceList[i].classname + '</option>').appendTo('#connectclass');
		}
	}
}

/**
 * side에 list들을 전부 띄워주는 함수. (실행하면 list들을 삭제하고 다시 그려준다.)
 */
function MVC_List_View(){
	
	$('#conlist').empty();
	$('#serlist').empty();
	$('#daolist').empty();
	$('#volist').empty();

	for(var i=0;i<controllerList.length;i++){
		$('<div style=" width:120px;float:left; margin-left:20px; margin-top:5px">'
				+'<label value="' + controllerList[i].classname + '">' + controllerList[i].classname + '</label>').appendTo('#conlist');
		$('<div style="float:left; margin-bottom:10px;margin-left:40px">'
				+ '<button class="btn btn-primary" onclick="List_Modify('+"\'" + controllerList[i].classname +"\'" +')">수정</button>').appendTo('#conlist');
		$('<div style="margin-bottom:10px">'
				+'<button class="btn btn-danger" onclick="List_Delete('+"\'" + controllerList[i].classname +"\'" +')">삭제</button></br>').appendTo('#conlist');
	}
	for(var i=0;i<serviceList.length;i++){
		$('<div style=" width:120px;float:left; margin-left:20px; margin-top:5px">'
				+ '<label value="' + serviceList[i].classname + '">' + serviceList[i].classname + '</label>').appendTo('#serlist');
		$('<div style="float:left; margin-bottom:10px;margin-left:40px">'
				+ '<button  class="btn btn-primary" onclick="List_Modify('+"\'" + serviceList[i].classname +"\'" +')">수정</button>').appendTo('#serlist');
		$('<div style="margin-bottom:10px">'
				+ '<button  class="btn btn-danger" onclick="List_Delete('+"\'" + serviceList[i].classname +"\'" +')">삭제</button></br>').appendTo('#serlist');
	}
	for(var i=0;i<daoList.length;i++){
		$('<div style=" width:120px;float:left; margin-left:20px; margin-top:5px">'
				+'<label value="' + daoList[i].classname + '">' + daoList[i].classname + '</label>').appendTo('#daolist');
		$('<div style="float:left; margin-bottom:10px;margin-left:40px">'
				+'<button class="btn btn-primary" onclick="List_Modify('+"\'" + daoList[i].classname +"\'" +')">수정</button>').appendTo('#daolist');
		$('<div style="margin-bottom:10px">'
				+ '<button class="btn btn-danger" onclick="List_Delete('+"\'" + daoList[i].classname +"\'" +')">삭제</button></br>').appendTo('#daolist');
	}
	for(var i=0;i<voList.length;i++){
		$('<div style=" width:120px;float:left; margin-left:20px;margin-top:5px">'
				+'<label value="' + voList[i].classname + '">' + voList[i].classname + '</label>').appendTo('#volist');
		$('<div style="float:left; margin-bottom:10px;margin-left:40px">'
				+'<button class="btn btn-primary" onclick="VOList_Modify('+"\'" + voList[i].classname +"\'" +')">수정</button>').appendTo('#volist');
		$(' <div style="margin-bottom:10px">'
				+'<button class="btn btn-danger" onclick="VOList_Delete('+"'" + voList[i].classname +"'" +')">삭제</button></br>').appendTo('#volist');
			}
		}
		
		/**
		 * form을 초기화 해주는 함수.
		 * */
		function FormInit(){
			
			// 폼의 값들을 초기화
			document.getElementById("classname").value = "";
			document.getElementById("connectclass").value = "";
			document.getElementById("valuename0").value = "";
			document.getElementById("select_value0").value = "int";
			document.getElementById("methodname0").value = "";
			document.getElementById("select_method0").value = "void";
			document.getElementById("voname").value = "";
			document.getElementById("vo_valname0").value = "";
			document.getElementById("select_voval0").value = "int";
			document.getElementById("direct_input_val0").value = "";
			document.getElementById("direct_input_val0").type = "hidden";
			document.getElementById("direct_input_func0").value = "";
			document.getElementById("direct_input_func0").type = "hidden";
			
			// 폼 초기화
			DelValueAllForm();
			DelMethodAllForm();
			DelVOAllForm();		
		}
		
		
		// DB에 DAO의 정보를 선택해주기위한 함수
		function DB_Connect_DAOList(){
			$("#connect_dao").empty();
			$('<option value="init">--선택하세요--</option>').appendTo("#connect_dao");
			for(var i=0;i<daoList.length;i++){
		$('<option value="'+daoList[i].classname+'">'+daoList[i].classname+'</option>').appendTo("#connect_dao");
			}
		}
		
		
		
		
		
		//db정보 emit해주는 함수
		//draw한 canvas정보들 emit해주는 함수
		function EmitDB(){
			
			socket.emit('db_infor', {
		db:db			
			
			});
			
			
		}
		
		
		
		
		//draw한 canvas정보들 emit해주는 함수
		function EmitCanvas(gb){
			if(gb==1){
		socket.emit('draw', {
			gb:gb,
			class:controller			
			
		});
			}else if(gb==2){
		socket.emit('draw', {
			gb:gb,
			class:service			
			
		});
			}else if(gb==3){
		socket.emit('draw', {
			gb:gb,
			class:dao			
			
		});
			}else if(gb==4){
		socket.emit('draw', {
			gb:gb,
			class:vo			
			
		});
			}
			
		}
		
		//수정한 canvas정보들 emit해주는 함수
		function EmitModifyCanvas(gb){
			if(gb==1){
		socket.emit('modifyCanvas', {
			gb:gb,
			m_class:modify_class,
			m_idx:modify_index,
			class:controller,
			m_conn_list:m_conn_list			
			
		});
			}else if(gb==2){
		socket.emit('modifyCanvas', {
			gb:gb,
			m_class:modify_class,
			m_idx:modify_index,
			class:service,
			m_conn_list:m_conn_list	
			
		});
			}else if(gb==3){
		socket.emit('modifyCanvas', {
			gb:gb,
			m_class:modify_class,
			m_idx:modify_index,
			class:dao,
			m_conn_list:m_conn_list				
			
		});
			}else if(gb==4){
		socket.emit('modifyCanvas', {
			gb:gb,
			m_class:modify_vo_class,
			m_idx:modify_vo_index,
			class:vo		
			
		});
			}
		}
		
		
		//삭제한 canvas정보들 emit해주는 함수
		function EmitDeleteCanvas(){
			
			if(gubun==4){
		socket.emit('deleteCanvas', {
			gb:gubun,
			d_class:delete_vo_class,
			d_idx:delete_vo_index		
			
		});
			}
			else{
		socket.emit('deleteCanvas', {
			gb:gubun,
			d_class:delete_class,
			d_idx:delete_index,
			d_conn_list:d_conn_list			
			
		});
			}
		}
		
		//move한 canvas정보들 emit해주는 함수
		function EmitMoveCanvas(){
			
			socket.emit('moveCanvas', {
			gb:gubun,
			mv_class:temp_r,
			mv_idx:temp_moving,
			start_x:temp_r.start_point_x,
			start_y:temp_r.start_point_y,
			end_x:temp_r.end_point_x,
			end_y:temp_r.end_point_y,
			
			});
			
		}
		
		//**수정 바뀐 연결정보를 emit
		function EmitConn(){
			
			socket.emit('connCanvas', {
			start_cn:startList.classname,
			startClass:startList,
			gb:gubun,
			start_idx:btnconn_startindex,
			end_cn:endList.classname,
			endClass:endList
			
			});
			
		}
		
		
		
		
		
			//mvc_modal_create.js
		/**
		 * List들을 순회하면서 class의 name들이 곂치는지 확인하기 위한 함수.
		 */
		function Duplication_Check(){
			
			if(check_package == "Controller"){
		if(controllerList.length != 0){
			for(var i=0;i<controllerList.length;i++){
				if(controllerList[i].classname != document.getElementById("classname").value + "Controller"){
					c_name = document.getElementById("classname").value;
					check_name = true;
				}else{
					alert("Controller의 Name이 중복 됩니다.");
					check_name = false;
					break;
				}
			}
		}else{
			c_name = document.getElementById("classname").value;
			check_name = true;
		}
			}else if(check_package == "Service"){
		if(serviceList.length != 0){
			for(var i=0;i<serviceList.length;i++){
				if(serviceList[i].classname != document.getElementById("classname").value + "Service"){
					c_name = document.getElementById("classname").value;
					check_name = true;
				}else{
					alert("Service의 Name이 중복 됩니다.");
					check_name = false;
					break;
				}
			}
		}else{
			c_name = document.getElementById("classname").value;
			check_name = true;
		}
			}else if(check_package == "DAO"){
		if(daoList.length != 0){
			for(var i=0;i<daoList.length;i++){
				if(daoList[i].classname != document.getElementById("classname").value + "DAO"){
					c_name = document.getElementById("classname").value;
					check_name = true;
				}else{
					alert("DAO의 Name이 중복 됩니다.");
					check_name = false;
					break;
				}
			}
		}else{
			c_name = document.getElementById("classname").value;
			check_name = true;
		}
			}else if(check_package == "mvc"){
		var check_name_con;
		var check_name_ser;
		var check_name_dao;
		
		if(controllerList.length != 0){
			for(var i=0;i<controllerList.length;i++){
				if(controllerList[i].classname != document.getElementById("classname").value + "Controller"){
					c_name = document.getElementById("classname").value;
					check_name_con = true;
				}else{
					alert("Controller의 Name이 중복 됩니다.");
					check_name_con = false;
					break;
				}
			}
		}else{
			c_name = document.getElementById("classname").value;
			check_name_con = true;
		}
		
		if(serviceList.length != 0){
			for(var i=0;i<serviceList.length;i++){
				if(serviceList[i].classname != document.getElementById("classname").value + "Service"){
					c_name = document.getElementById("classname").value;
					check_name_ser = true;
				}else{
					alert("Service의 Name이 중복 됩니다.");
					check_name_ser = false;
					break;
				}
			}
		}else{
			c_name = document.getElementById("classname").value;
			check_name_ser = true;
		}
		
		if(controllerList.length != 0){
			for(var i=0;i<daoList.length;i++){
				if(daoList[i].classname != document.getElementById("classname").value + "DAO"){
					c_name = document.getElementById("classname").value;
					check_name_dao = true;
				}else{
					alert("DAO의 Name이 중복 됩니다.");
					check_name_dao = false;
					break;
				}
			}
		}else{
			c_name = document.getElementById("classname").value;
			check_name_dao = true;
		}
		
		if(check_name_con == true && check_name_ser == true && check_name_dao == true){
			check_name = true;
		}else{
			check_name = false;
		}
			}
		}
		
		/**
		 * document의 input tag에 저장되어 있는 값들을 불러오는 함수.
		 */
		function Call_Value(){
			// 중복된 class의 이름이 없으면 document의 값을 받아와 배열에 저장
			if(check_name == true){
		for(var i=0; i<val_count; i++){
			v_name[i] = document.getElementById("valuename"+i);
			select_val[i] = document.getElementById("select_value"+i);
			direct_val[i] = document.getElementById("direct_input_val"+i);
		}
		
		for(var i=0; i<m_count; i++){
			m_name[i] = document.getElementById("methodname"+i);
			select_func[i] = document.getElementById("select_method"+i);
			direct_func[i] = document.getElementById("direct_input_func"+i);
		}
		
		// 각 document의 값들을 저장.
		if(check_package != "mvc"){
			draw_className = c_name;
			connectclass = document.getElementById("connectclass").value;
		}
		
		// select box의 값이 선택되면 변수명 앞에 select box의 값을 붙여줌.
		for(var j=0; j<val_count; j++){
			draw_valueName[j] = v_name[j].value;
			draw_select_val[j] = select_val[j].value;
			draw_direct_val[j] = direct_val[j].value;
		}
		
		// select box의 값이 선택되면 메소드명 앞에 select box의 값을 붙여줌.
		for(var j=0; j<m_count; j++){
			draw_methodName[j] = m_name[j].value;
			draw_select_func[j] = select_func[j].value;
			draw_direct_func[j] = direct_func[j].value;
		}
			}
		}
		
		
		/**
		 * 연결할 class를 탐색해줌.
		 */
		function Connect_Class_Check(){
			if(check_package == "Controller" && connectclass != "init"){
		for(var i=0;i<serviceList.length;i++){
			if(connectclass == serviceList[i].classname){
				conn_index = i;
				conn_ser = true;
				break;
			}else{
				conn_ser = false;
			}
		}
		
		for(var i=0;i<daoList.length;i++){
			if(connectclass == daoList[i].classname){
				conn_index = i;
				conn_dao = true;
				break;
			}else{
				conn_dao = false;
			}
		}
		
			}else if(check_package == "Service" && connectclass != "init"){
		for(var i=0;i<controllerList.length;i++){
			if(connectclass == controllerList[i].classname){
				conn_index = i;
				conn_con = true;
				break;
			}else{
				conn_con = false;
			}
		}
		
		for(var i=0;i<daoList.length;i++){
			if(connectclass == daoList[i].classname){
				conn_index = i;
				conn_dao = true;
				break;
			}else{
				conn_dao = false;
			}
		}
		
			}else if(check_package == "DAO"  && connectclass != "init"){
		for(var i=0;i<controllerList.length;i++){
			if(connectclass == controllerList[i].classname){
				conn_index = i;
				conn_con = true;
				break;
			}else{
				conn_con = false;
			}
		}
		
		for(var i=0;i<serviceList.length;i++){
			if(connectclass == serviceList[i].classname){
				conn_index = i;
				conn_ser = true;
				break;
			}else{
				conn_ser = false;
			}
		}		
			}
		}
		
		/**
		 * connectclass에 입력하여 연결하고자 하는 class를 찾아서 그 좌표를 가져오는 함수
		 */
		function Connection_Class(){
			
			Connect_Class_Check();
			
			if(conn_con == true){
		conn_point_X = controllerList[conn_index].end_point_x;
		conn_point_Y = controllerList[conn_index].end_point_y;
		
			}else if(conn_ser == true){
		conn_point_X = serviceList[conn_index].end_point_x;
		conn_point_Y = serviceList[conn_index].end_point_y;
		
			}else if(conn_dao == true){
		conn_point_X = daoList[conn_index].end_point_x;
		conn_point_Y = daoList[conn_index].end_point_y;
			}
		}
		
		function All_Draw_Connect_Line(){
		
			for (var i=0;i<controllerList.length;i++) {
		if (connectclass == controllerList[i].classname) {
			conn_index = i;
			conn_con = true;
			break;
		} else {
			conn_con = false;
		}
			}
		
			for (var i=0;i<serviceList.length;i++) {
		if (connectclass == serviceList[i].classname) {
			conn_index = i;
			conn_ser = true;
			break;
		} else {
			conn_ser = false;
		}
			}
		
			for (var i=0;i<daoList.length;i++) {
		if (connectclass == daoList[i].classname) {
			conn_index = i;
			conn_dao = true;
			break;
		} else {
			conn_dao = false;
		}
			}
			
			if(conn_con){
		conn_point_X = controllerList[conn_index].end_point_x;
		conn_point_Y = controllerList[conn_index].end_point_y;
			}else if(conn_ser){
		conn_point_X = serviceList[conn_index].end_point_x;
		conn_point_Y = serviceList[conn_index].end_point_y;
			}else if(conn_dao){
		conn_point_X = daoList[conn_index].end_point_x;
		conn_point_Y = daoList[conn_index].end_point_y;
			}
			
		}
		
		/**
		 * document에서 받아온 값들을 list에 저장하는 함수
		 */
		function Value_List_Save(){
			// 각각 들어오는 check_package의 값에 따라서 classname을 따로 저장
			if(check_package == "Controller"){
		// class name이 중복되지 않고 null이 아니면 값을 list에 저장. 
		if(check_name == true && c_name != ""){
		
		
			draw_className += "Controller";
			gubun=1;
			controller = new element();
			controller.classname = draw_className;
			controller.valuename = draw_valueName;
			controller.methodname = draw_methodName;
			controller.selectvalue = draw_select_val;
			controller.selectmethod = draw_select_func;
			controller.directvalue = draw_direct_val;
			controller.directmethod = draw_direct_func;
			controller.connclassname = connectclass;
			controller.start_point_x = xpos;
			controller.start_point_y = ypos;
			controller.end_point_x = end_xpos;
			controller.end_point_y = end_ypos;
			
			//controllerList[con_cnt] = controller;
			
			//con_cnt++;
			EmitCanvas(gubun);
		}
			}else if(check_package == "Service"){
		if(check_name == true && c_name != ""){
			
		
			draw_className += "Service";
			gubun=2;	
			service = new element();
			service.classname = draw_className;
			service.valuename = draw_valueName;
			service.methodname = draw_methodName;
			service.selectvalue = draw_select_val;
			service.selectmethod = draw_select_func;
			service.directvalue = draw_direct_val;
			service.directmethod = draw_direct_func;
			service.connclassname = connectclass;
			service.start_point_x = xpos;
			service.start_point_y = ypos;
			service.end_point_x = end_xpos;
			service.end_point_y = end_ypos;
			
			//serviceList[ser_cnt] = service;
			
			//ser_cnt++;
			EmitCanvas(gubun);
		}
			}else if(check_package == "DAO"){
		if(check_name == true && c_name != ""){
			
		
			draw_className += "DAO";
			gubun=3;
			dao = new element();
			dao.classname = draw_className;
			dao.valuename = draw_valueName;
			dao.methodname = draw_methodName;
			dao.selectvalue = draw_select_val;
			dao.selectmethod = draw_select_func;
			dao.directvalue = draw_direct_val;
			dao.directmethod = draw_direct_func;
			dao.connclassname = connectclass;
			dao.start_point_x = xpos;
			dao.start_point_y = ypos;
			dao.end_point_x = end_xpos;
			dao.end_point_y = end_ypos;
			
			//daoList[dao_cnt] = dao;
			
			//dao_cnt++;
			EmitCanvas(gubun);
		}
			}else if(check_package == "mvc"){ //**수정
		if(check_name == true && c_name != ""){
		
			controller = new element();
			service = new element();
			dao = new element();
			
			var temp = [];
			temp[0]="";
			connectclass = "init";
		    draw_className = c_name + "Controller";
			
		    /* test4 : 민섭 */
		    var v_length = 0;
			var m_length = 0;
			var sv_length = 0;
			var sm_length = 0;
			
			var c_length = Length_Compare(draw_className.length, v_length + sv_length, m_length + sm_length);
			Connect_SavePoint(c_length,temp.length, temp.length);
			// controller 값을 list에 저장
			
			gubun=1;
			controller.classname = draw_className;
			controller.valuename = temp;
			controller.methodname = temp;
			controller.selectvalue = temp;
			controller.selectmethod = temp;
			controller.directvalue = temp;
			controller.directmethod = temp;
			controller.connclassname = connectclass;
			controller.start_point_x = xpos;
			controller.start_point_y = ypos;
			controller.end_point_x = end_xpos;
			controller.end_point_y = end_ypos;
			
			//controllerList[con_cnt] = controller;
			EmitCanvas(gubun);
		
			// service 값을 list에 저장
			xpos = xpos + 200;
			ypos = ypos + 200;
		            connectclass =  draw_className;
		            draw_className = c_name + "Service";
			
		            /* test4 : 민섭 */
				    var v_length = 0;
					var m_length = array_Compare(draw_methodName);
					var sv_length = 0;
					var sm_length = array_Compare2(draw_select_func,draw_direct_func);
					
					var c_length = Length_Compare(draw_className.length, v_length + sv_length, m_length + sm_length);
					Connect_SavePoint(c_length,temp.length, draw_methodName.length);
		    
			gubun=2;
			service.classname = draw_className;
			service.valuename = temp;
			service.methodname = draw_methodName;
			service.selectvalue = temp;
			service.selectmethod = draw_select_func;
			service.directvalue = temp;
			service.directmethod = draw_direct_func;
			service.connclassname = connectclass;
			service.start_point_x = xpos;
			service.start_point_y = ypos;
			service.end_point_x = end_xpos;
			service.end_point_y = end_ypos;
			
			//serviceList[ser_cnt] = service;
			EmitCanvas(gubun);
		
			//dao 값을 list에 저장
			xpos = xpos + 200;
			ypos = ypos + 200;
			connectclass =  draw_className;
		            draw_className = c_name + "DAO";
			
		            /* test4 : 민섭 */
				    var v_length = array_Compare(draw_valueName);
					var m_length = array_Compare(draw_methodName);
					var sv_length = array_Compare2(draw_select_val,draw_direct_val);
					var sm_length = array_Compare2(draw_select_func,draw_direct_func);
					
					var c_length = Length_Compare(draw_className.length, v_length + sv_length, m_length + sm_length);
					Connect_SavePoint(c_length,draw_valueName.length, draw_methodName.length);
			gubun=3;
			dao.classname = draw_className;
			dao.valuename = draw_valueName;
			dao.methodname = draw_methodName;
			dao.selectvalue = draw_select_val;
			dao.selectmethod = draw_select_func;
			dao.directvalue = draw_direct_val;
			dao.directmethod = draw_direct_func;
			dao.connclassname = connectclass;
			dao.start_point_x = xpos;
			dao.start_point_y = ypos;
			dao.end_point_x = end_xpos;
			dao.end_point_y = end_ypos;
			
			//daoList[dao_cnt] = dao;
			EmitCanvas(gubun);
			//con_cnt++;
			//ser_cnt++;
			//dao_cnt++;
		}
			}
		}
		
		function ValuesInit(){
			check_package = "";
			c_name = "";
			v_name = [];
			m_name = [];
			select_val = [];
			select_func = [];
			connectclass = "init";
		
			conn_index = -1;
			check_name = false;
			check_name_con = false;
			check_name_ser = false;
			check_name_dao = false;
			conn_ser = false;
			conn_dao = false;
			conn_con = false;
			
		}
		
			//mvc_modal_vo_create.js
		/**
		 * List들을 순회하면서 class의 name들이 곂치는지 확인하기 위한 함수.(vo)
		 */
		function Duplication_VO_Check(){
			if(voList.length != 0){
		for(var i=0;i<voList.length;i++){
			if(voList[i].classname != document.getElementById("voname").value + "VO"){
				c_name = document.getElementById("voname").value;
				check_name = true;
			}else{
				alert("VO의 Name이 중복 됩니다.");
				check_name = false;
				break;
			}
		}
			}else{
		c_name = document.getElementById("voname").value;
		check_name = true;
			}
		}
		
		/**
		 * document의 input tag에 저장되어 있는 값들을 불러오는 함수.(vo)
		 */
		function Call_VO_Value(){
			// 중복된 class의 이름이 없으면 document의 값을 받아와 배열에 저장
			if(check_name == true){
		for(var i=0; i<vo_valcount; i++){
			v_name[i] = document.getElementById("vo_valname"+i);
			select_val[i] = document.getElementById("select_voval"+i);
		}
		
		// select box의 값이 선택되면 변수명 앞에 select box의 값을 붙여줌.
		for(var j=0; j<vo_valcount; j++){
			draw_valueName[j] = v_name[j].value;
			draw_select_val[j] = select_val[j].value;
		}
			}
		}
		
		/**
		 * document에서 받아온 값들을 list에 저장하는 함수(vo)
		 */
		function Value_VOList_Save(){
			if(check_name == true && c_name != ""){
		
		c_name += "VO";
		
		vo = new vo_element();
		vo.classname = c_name;
		vo.valuename = draw_valueName;
		vo.selectvalue = draw_select_val;
		
		gubun=4;
		EmitCanvas(gubun);
		
		//voList[vo_cnt] = vo;
			
		//vo_cnt++;
			}
		}
		
		
		
		
			//mvc_modal_modify.js
		/**
		 * 수정 button을 눌렀을 떄 호출되는 함수.
		 */
		function List_Modify(a){
			
			modify_class = a;
			
			modify_choice = true;
			Search_List_Modify();
			
			if(modify_con){	
		
		check_package = "Controller";
		
		document.getElementById("classname").value = controllerList[modify_index].classname;
		// value와 method의 개수만큼 form을 늘려줌. 
		for(var i=1;i<controllerList[modify_index].valuename.length;i++){
			AddValueForm();
		}
		for(var i=1;i<controllerList[modify_index].methodname.length;i++){
			AddMethodForm();
		}
		// form의 값을 설정해줌
		for(var i=0; i<val_count; i++){
			document.getElementById("valuename"+i).value = controllerList[modify_index].valuename[i];
			document.getElementById("select_value"+i).value = controllerList[modify_index].selectvalue[i];
		}
		for(var i=0; i<m_count; i++){
			document.getElementById("methodname"+i).value = controllerList[modify_index].methodname[i];
			document.getElementById("select_method"+i).value = controllerList[modify_index].selectmethod[i];
		}
		
		Dynamic_Connect_List();
		document.getElementById("connectclass").value = controllerList[modify_index].connclassname;
		
		xpos = controllerList[modify_index].start_point_x;
		ypos = controllerList[modify_index].start_point_y;
		
		// modal창을 불러옴
		$(document).ready(function(){
			$("#myModal").modal();
		});
		
			}else if(modify_ser){
		
		check_package = "Service";
		
		document.getElementById("classname").value = serviceList[modify_index].classname;
		// value와 method의 개수만큼 form을 늘려줌. 
		for(var i=1;i<serviceList[modify_index].valuename.length;i++){
			AddValueForm();
		}
		for(var i=1;i<serviceList[modify_index].methodname.length;i++){
			AddMethodForm();
		}
		
		// form의 값을 설정해줌
		for(var i=0; i<val_count; i++){
			document.getElementById("valuename"+i).value = serviceList[modify_index].valuename[i];
			document.getElementById("select_value"+i).value = serviceList[modify_index].selectvalue[i];
		}
		for(var i=0; i<m_count; i++){
			document.getElementById("methodname"+i).value = serviceList[modify_index].methodname[i];
			document.getElementById("select_method"+i).value = serviceList[modify_index].selectmethod[i];
		}
		
		Dynamic_Connect_List();
		document.getElementById("connectclass").value = serviceList[modify_index].connclassname;
		
		xpos = serviceList[modify_index].start_point_x;
		ypos = serviceList[modify_index].start_point_y;
		
		$(document).ready(function(){
			$("#myModal").modal();
		});
			}else if(modify_dao){
		
		check_package = "DAO";
		
		document.getElementById("classname").value = daoList[modify_index].classname;
		// value와 method의 개수만큼 form을 늘려줌. 
		for(var i=1;i<daoList[modify_index].valuename.length;i++){
			AddValueForm();
		}
		for(var i=1;i<daoList[modify_index].methodname.length;i++){
			AddMethodForm();
		}
		
		// form의 값을 설정해줌
		for(var i=0; i<val_count; i++){
			document.getElementById("valuename"+i).value = daoList[modify_index].valuename[i];
			document.getElementById("select_value"+i).value = daoList[modify_index].selectvalue[i];
		}
		for(var i=0; i<m_count; i++){
			document.getElementById("methodname"+i).value = daoList[modify_index].methodname[i];
			document.getElementById("select_method"+i).value = daoList[modify_index].selectmethod[i];
		}
		
		Dynamic_Connect_List();  
		document.getElementById("connectclass").value = daoList[modify_index].connclassname;
		
		xpos = daoList[modify_index].start_point_x;
		ypos = daoList[modify_index].start_point_y;
		
		$(document).ready(function(){
			$("#myModal").modal();
		});
			}
		}
		
		/**
		 * 수정을 위한 탐색 함수
		 */
		function Search_List_Modify(){
			
			// controllerList 탐색
			for(var i=0;i<controllerList.length;i++){
		if(modify_class == controllerList[i].classname){
			modify_index = i;
			modify_con = true;
			break;
		}else{
			modify_con = false;
		}
			}
			
			// serviceList 탐색
			for(var i=0;i<serviceList.length;i++){
		if(modify_class == serviceList[i].classname){
			modify_index = i;
			modify_ser = true;
			break;
		}else{
			modify_ser = false;
		}
			}
			
			// daoList 탐색
			for(var i=0;i<daoList.length;i++){
		if(modify_class == daoList[i].classname){
			modify_index = i;
			modify_dao = true;
			break;
		}else{
			modify_dao = false;
		}
			}
		}
		
		/**
		 * 연결된 class들을 찾아서 이름을 바꾸어주는 함수.
		 */
		function Modify_Conn_List(){
			
			m_conn_list=[]; //연결된 class들의 리스트
			m_conn_size=0;
			//연결된 class 구조체
			function m_conn_class(){
		var m_conn_gb=0; //어떤것(controller or service or..etc...)에 연결된클래스이름을 수정하는지
		var m_conn_cl=''; //연결된 클래스 이름을 수정해야하는 클래스 이름 
		var m_conn_idx=0; //연결된 클래스 이름을 수정해야하는 클래스 인덱스 
			}
			var m_conn_c; //연결된 클래스 구조체 변수
			// controllerList의 connectclass를 탐색
			for(var i=0;i<controllerList.length;i++){
		if(modify_class == controllerList[i].connclassname){
			if(check_package == "Service"){
				//controllerList[i].connclassname = serviceList[modify_index].classname;
				m_conn_c=new m_conn_class();
				m_conn_c.m_conn_gb=1;
				m_conn_c.m_conn_idx=i;
				m_conn_c.m_conn_cl=controllerList[i].classname;
				m_conn_list[m_conn_size]=m_conn_c;
				m_conn_size++;
			}else if(check_package == "DAO"){
				//controllerList[i].connclassname = dao[modify_index].classname;
				m_conn_c=new m_conn_class();
				m_conn_c.m_conn_gb=1;
				m_conn_c.m_conn_idx=i;
				m_conn_c.m_conn_cl=controllerList[i].classname;
				m_conn_list[m_conn_size]=m_conn_c;
				m_conn_size++;
			}
		}
			}
			
			// serviceList의 connectclass를 탐색
			for(var i=0;i<serviceList.length;i++){
		if(modify_class == serviceList[i].connclassname){
			if(check_package == "Controller"){
				//serviceList[i].connclassname = controllerList[modify_index].classname;
				m_conn_c=new m_conn_class();
				m_conn_c.m_conn_gb=2;
				m_conn_c.m_conn_idx=i;
				m_conn_c.m_conn_cl=serviceList[i].classname;
				m_conn_list[m_conn_size]=m_conn_c;
				m_conn_size++;
			}else if(check_package == "DAO"){
				//serviceList[i].connclassname = daoList[modify_index].classname;
				m_conn_c=new m_conn_class();
				m_conn_c.m_conn_gb=2;
				m_conn_c.m_conn_idx=i;
				m_conn_c.m_conn_cl=serviceList[i].classname;
				m_conn_list[m_conn_size]=m_conn_c;
				m_conn_size++;
			}
		}
			}
			
			// daoList의 connectclass를 탐색
			for(var i=0;i<daoList.length;i++){
		if(modify_class == daoList[i].connclassname){
			if(check_package == "Controller"){
				//daoList[i].connclassname = controllerList[modify_index].classname;
				m_conn_c=new m_conn_class();
				m_conn_c.m_conn_gb=3;
				m_conn_c.m_conn_idx=i;
				m_conn_c.m_conn_cl=daoList[i].classname;
				m_conn_list[m_conn_size]=m_conn_c;
				m_conn_size++;
			}else if(check_package == "Service"){
				//daoList[i].connclassname = serviceList[modify_index].classname;
				m_conn_c=new m_conn_class();
				m_conn_c.m_conn_gb=3;
				m_conn_c.m_conn_idx=i;
				m_conn_c.m_conn_cl=daoList[i].classname;
				m_conn_list[m_conn_size]=m_conn_c;
				m_conn_size++;
			}
		}
			}
		}
		
		/**
		 * 수정할 때 classname이 중복되지 않게 check하기 위한 함수.
		 */
		function Duplication_Check_Modify(){
			if(check_package == "Controller"){
		for(var i=0;i<controllerList.length;i++){
			if(controllerList[i].classname != document.getElementById("classname").value){
				c_name = document.getElementById("classname").value;
				check_name = true;
			}else{
				if(modify_index == i){
					c_name = document.getElementById("classname").value;
					check_name = true;
				}else{
					alert("Controller의 Name이 중복 됩니다.");
					check_name = false;
					break;
				}
			}
		}
			}else if(check_package == "Service"){
		for(var i=0;i<serviceList.length;i++){
			if(serviceList[i].classname != document.getElementById("classname").value){
				c_name = document.getElementById("classname").value;
				check_name = true;
			}else{
				if(modify_index == i){
					c_name = document.getElementById("classname").value;
					check_name = true;
				}else{
					alert("Service의 Name이 중복 됩니다.");
					check_name = false;
					break;
				}
			}
		}
			}else if(check_package == "DAO"){
		for(var i=0;i<daoList.length;i++){
			if(daoList[i].classname != document.getElementById("classname").value){
				c_name = document.getElementById("classname").value;
				check_name = true;
			}else{
				if(modify_index == i){
					c_name = document.getElementById("classname").value;
					check_name = true;
				}else{
					alert("DAO의 Name이 중복 됩니다.");
					check_name = false;
					break;
				}
			}
		}
			}
		}
		
		/**
		 * 수정된 값을 list에 저장하는 함수.
		 */
		function Modify_Value_List_Save(){
			// 각각 들어오는 check_package의 값에 따라서 classname을 따로 저장
			if(check_package == "Controller"){
		// class name이 중복되지 않고 null이 아니면 값을 list에 저장. 
		if(check_name == true && c_name != ""){
			
			
			gubun=1;
			controller = new element();
			controller.classname = draw_className;
			controller.valuename = draw_valueName;
			controller.methodname = draw_methodName;
			controller.selectvalue = draw_select_val;
			controller.selectmethod = draw_select_func;
			controller.connclassname = connectclass;
			controller.start_point_x = controllerList[modify_index].start_point_x;
			controller.start_point_y = controllerList[modify_index].start_point_y;
			controller.end_point_x = end_xpos;
			controller.end_point_y = end_ypos;
			
			//controllerList[modify_index] = controller;
			Modify_Conn_List();
			EmitModifyCanvas(gubun);
			
		}
			}else if(check_package == "Service"){
		if(check_name == true && c_name != ""){
			
			
			gubun=2;	
			service = new element();
			service.classname = draw_className;
			service.valuename = draw_valueName;
			service.methodname = draw_methodName;
			service.selectvalue = draw_select_val;
			service.selectmethod = draw_select_func;
			service.connclassname = connectclass;
			service.start_point_x = serviceList[modify_index].start_point_x;
			service.start_point_y = serviceList[modify_index].start_point_y;
			service.end_point_x = end_xpos;
			service.end_point_y = end_ypos;
			
			//serviceList[modify_index] = service;
			Modify_Conn_List();
			EmitModifyCanvas(gubun);
		}
			}else if(check_package == "DAO"){
		if(check_name == true && c_name != ""){
			
			
			gubun=3;
			dao = new element();
			dao.classname = draw_className;
			dao.valuename = draw_valueName;
			dao.methodname = draw_methodName;
			dao.selectvalue = draw_select_val;
			dao.selectmethod = draw_select_func;
			dao.connclassname = connectclass;
			dao.start_point_x = daoList[modify_index].start_point_x;
			dao.start_point_y = daoList[modify_index].start_point_y;
			dao.end_point_x = end_xpos;
			dao.end_point_y = end_ypos;
			
			//daoList[modify_index] = dao;
			Modify_Conn_List();
			EmitModifyCanvas(gubun);
		}
			}
		}
		
		
		//추가..
		function MoveRectangle(x,y){
			// controllerList에서 움직일 class를 찾을 때...
			for (var i = 0;i < controllerList.length;i++) {
		var r = controllerList[i];
		if (x > r.start_point_x && x < r.end_point_x && y > r.start_point_y && y < r.end_point_y) {
			move_con = true;
			moving = i;
			break;
		}else{
			move_con = false;
		}
			}
			
			// serviceList에서 움직일 class를 찾을 때...
			for (var i = 0;i < serviceList.length;i++) {
		var r = serviceList[i];
		if (x > r.start_point_x && x < r.end_point_x && y > r.start_point_y && y < r.end_point_y) {
			move_ser = true;
			moving = i;
			break;
		}else{
			move_ser = false;
		}
			}
			
			// daoList에서 움직일 class를 찾을 때...
			for (var i = 0;i < daoList.length;i++) {
		var r = daoList[i];
		if (x > r.start_point_x && x < r.end_point_x && y > r.start_point_y && y < r.end_point_y) {
			move_dao = true;
			moving = i;
			break;
		}else{
			move_dao = false;
		}
			}
			
			if(move_con == false && move_ser == false && move_dao == false){
		moving = -1;
			}
		}
		
		
		
		function ModifyInit(){
			modify_class = "";
			modify_choice = false;
			modify_con = false;
			modify_ser = false;
			modify_dao = false;
			modify_index = -1;
		}
		
		
		
			//mvc_modal_vo_modify.js
		/**
		 * 수정 button을 눌렀을 떄 호출되는 함수.
		 */
		function VOList_Modify(a){
			
			modify_vo_class = a;
			
			modify_vo_choice = true;
			Search_VOList_Modify();
			
			if(modify_vo){	
		
		document.getElementById("voname").value = voList[modify_vo_index].classname;
		// value와 method의 개수만큼 form을 늘려줌. 
		for(var i=1;i<voList[modify_vo_index].valuename.length;i++){
			AddVOForm();
		}
		
		// form의 값을 설정해줌
		for(var i=0; i<vo_valcount; i++){
			document.getElementById("vo_valname"+i).value = voList[modify_vo_index].valuename[i];
			document.getElementById("select_voval"+i).value = voList[modify_vo_index].selectvalue[i];
		}
		
			/*	Dynamic_Connect_List();
		document.getElementById("connectclass").value = controllerList[modify_index].connclassname;
		
		xpos = controllerList[modify_vo_index].start_point_x;
		ypos = controllerList[modify_vo_index].start_point_y;*/
		
		// modal창을 불러옴
		$(document).ready(function(){
			$("#voModal").modal();
		});
		
			}
		}
		
		/**
		 * 수정을 위한 탐색 함수
		 */
		function Search_VOList_Modify(){
			
			// voList 탐색
			for(var i=0;i<voList.length;i++){
		if(modify_vo_class == voList[i].classname){
			modify_vo_index = i;
			modify_vo = true;
			break;
		}else{
			modify_vo = false;
		}
			}
		}
		
		/**
		 * 수정할 때 vo_name이 중복되지 않게 check하기 위한 함수.
		 */
		function Duplication_Check_VO_Modify(){
			for(var i=0;i<voList.length;i++){
		if(voList[i].classname != document.getElementById("voname").value){
			c_name = document.getElementById("voname").value;
			check_name = true;
			break;
		}else{
			if(modify_vo_index == i){
				c_name = document.getElementById("voname").value;
				check_name = true;
				break;
			}else{
				alert("VO의 Name이 중복 됩니다.");
				check_name = false;
				break;
			}
		}
			}
		}
		
		/**
		 * 수정된 값을 volist에 저장하는 함수.
		 */
		function Modify_Value_VOList_Save(){
			if(check_name == true && c_name != ""){
		
		
		vo = new vo_element();
		vo.classname = c_name;
		vo.valuename = draw_valueName;
		vo.selectvalue = draw_select_val;
		
		//voList[modify_vo_index] = vo;
		gubun=4;
		EmitModifyCanvas(gubun);
			}
		}
		
		
		function ModifyVOInit(){
			modify_vo_class = "";
			modify_vo = false;
			modify_vo_index = -1;
			modify_vo_choice = false;
		}
		
		
		
			//mvc_modal_delete.js
		
		/**
		 * 삭제 button을 눌렀을 때 호출되는 함수.
		 */
		function List_Delete(a){
			
			delete_class = a;
			Search_List_Delete();
			
			if(delete_con){
		check_package = "Controller";
		gubun=1;
		Delete_Conn_List();
		EmitDeleteCanvas();
		//Delete_Value_List_Save();
		/*if(con_cnt > 0){
			con_cnt--;
		}*/
			}else if(delete_ser){
		check_package = "Service";
		gubun=2;
		Delete_Conn_List();
		EmitDeleteCanvas();
		//Delete_Value_List_Save();
		/*if(ser_cnt > 0){
			ser_cnt--;
		}*/
			}else if(delete_dao){
		check_package = "DAO";
		gubun=3;
		Delete_Conn_List();
		EmitDeleteCanvas();
		//Delete_Value_List_Save();
		/*if(dao_cnt > 0){
			dao_cnt--;
		}*/
			}
			
			//Erase_Canvas();
			//Draw_AllList();
			
			//MVC_List_View();
			
			All_Init();
		}
		
		/**
		 * 삭제할 index를 찾는 함수.
		 */
		function Search_List_Delete(){
			// controllerList 탐색
			for(var i=0;i<controllerList.length;i++){
		if(delete_class == controllerList[i].classname){
			delete_index = i;
			delete_con = true;
			break;
		}else{
			delete_con = false;
		}
			}
			
			// serviceList 탐색
			for(var i=0;i<serviceList.length;i++){
		if(delete_class == serviceList[i].classname){
			delete_index = i;
			delete_ser = true;
			break;
		}else{
			delete_ser = false;
		}
			}
			
			// daoList 탐색
			for(var i=0;i<daoList.length;i++){
		if(delete_class == daoList[i].classname){
			delete_index = i;
			delete_dao = true;
			break;
		}else{
			delete_dao = false;
		}
			}
		}
		
		/**
		 * 찾은 index를 삭제하고 index를 당기는 함수.
		 */
		/*
		function Delete_Value_List_Save(){
			if(check_package == "Controller"){
		controllerList.splice(delete_index,1);
			}else if(check_package == "Service"){
		serviceList.splice(delete_index,1);
			}else if(check_package == "DAO"){
		daoList.splice(delete_index,1);
			}
		}*/
		
		function Delete_Conn_List(){
			
			d_conn_list=[]; //연결된 class들의 리스트
			d_conn_size=0;
			//연결된 class 구조체
			function d_conn_class(){
		var d_conn_gb=0; //어떤것(controller or service or..etc...)에 연결된클래스이름을 삭제하는지
		var d_conn_cl=''; //연결된 클래스 이름을 삭제해야하는 클래스 이름 
		var d_conn_idx=0; //연결된 클래스 이름을 삭제해야하는 클래스 인덱스 
			}
			var d_conn_c; //연결된 클래스 구조체 변수
		
			// controllerList의 connectclass를 탐색
			for(var i=0;i<controllerList.length;i++){
		if(delete_class == controllerList[i].connclassname){
			if(check_package == "Service"){
				//controllerList[i].connclassname = "init";
				d_conn_c=new d_conn_class();
				d_conn_c.d_conn_gb=1;
				d_conn_c.d_conn_idx=i;
				d_conn_c.d_conn_cl=controllerList[i].classname;
				d_conn_list[d_conn_size]=d_conn_c;
				d_conn_size++;
			}else if(check_package == "DAO"){
				//controllerList[i].connclassname = "init";
				d_conn_c=new d_conn_class();
				d_conn_c.d_conn_gb=1;
				d_conn_c.d_conn_idx=i;
				d_conn_c.d_conn_cl=controllerList[i].classname;
				d_conn_list[d_conn_size]=d_conn_c;
				d_conn_size++;
			}
		}
			}
			
			// serviceList의 connectclass를 탐색
			for(var i=0;i<serviceList.length;i++){
		if(delete_class == serviceList[i].connclassname){
			if(check_package == "Controller"){
				//serviceList[i].connclassname = "init";
				d_conn_c=new d_conn_class();
				d_conn_c.d_conn_gb=2;
				d_conn_c.d_conn_idx=i;
				d_conn_c.d_conn_cl=serviceList[i].classname;
				d_conn_list[d_conn_size]=d_conn_c;
				d_conn_size++;
			}else if(check_package == "DAO"){
				//serviceList[i].connclassname = "init";
				d_conn_c=new d_conn_class();
				d_conn_c.d_conn_gb=2;
				d_conn_c.d_conn_idx=i;
				d_conn_c.d_conn_cl=serviceList[i].classname;
				d_conn_list[d_conn_size]=d_conn_c;
				d_conn_size++;
			}
		}
			}
			
			// daoList의 connectclass를 탐색
			for(var i=0;i<daoList.length;i++){
		if(delete_class == daoList[i].connclassname){
			if(check_package == "Controller"){
				//daoList[i].connclassname = "init";
				d_conn_c=new d_conn_class();
				d_conn_c.d_conn_gb=3;
				d_conn_c.d_conn_idx=i;
				d_conn_c.d_conn_cl=daoList[i].classname;
				d_conn_list[d_conn_size]=d_conn_c;
				d_conn_size++;
			}else if(check_package == "Service"){
				//daoList[i].connclassname = "init";
				d_conn_c=new d_conn_class();
				d_conn_c.d_conn_gb=3;
				d_conn_c.d_conn_idx=i;
				d_conn_c.d_conn_cl=daoList[i].classname;
				d_conn_list[d_conn_size]=d_conn_c;
				d_conn_size++;
			}
		}
			}
		}
		
		/**
		 * 사용한 값들을 초기화하는 함수.
		 */
		function DeleteInit(){
			delete_class = "";
			delete_con = false;
			delete_ser = false;
			delete_dao = false;
			delete_index = -1;
		}
		
		
			//mvc_modal_vo_delete.js
		/**
		 * 삭제 button을 눌렀을 때 호출되는 함수.
		 */
		function VOList_Delete(a){
			
			delete_vo_class = a;
			Search_VOList_Delete();
			
			if(delete_vo){
		gubun=4;
		EmitDeleteCanvas();
		/*Delete_Value_VOList_Save();
		if(vo_cnt > 0){
			vo_cnt--;
		}*/
			}
			
			//MVC_List_View();
			
			All_Init();
		}
		
		/**
		 * 삭제할 index를 찾는 함수.
		 */
		function Search_VOList_Delete(){
			for(var i=0;i<voList.length;i++){
		if(delete_vo_class == voList[i].classname){
			delete_vo_index = i;
			delete_vo = true;
			break;
		}else{
			delete_vo = false;
		}
			}
		}
		
		/**
		 * 찾은 index를 삭제하고 index를 당기는 함수.
		*/
		/*
		function Delete_Value_VOList_Save(){
			voList.splice(delete_vo_index,1);
		}
		*/
		
		/**
		 * 사용한 값들을 초기화하는 함수.
		 */
		function DeleteVOInit(){
			delete_vo_class = "";
			delete_vo = false;
			delete_vo_index = -1;
		}
		
		
		
		
		
		
			//mvc_modal.js
		// 각 input box의 id값을 가져와서 배열에 저장하고 canvas를 그려주는 함수. modal창의 ok button을 누르면 실행됨.
		function OnOK() {
			
			if(!modify_choice){
		        
		Duplication_Check();
		Call_Value();
		
		/* test4 : 민섭 */
		var v_length = array_Compare(draw_valueName);
		var m_length = array_Compare(draw_methodName);
		var sv_length = array_Compare2(draw_select_val,draw_direct_val);
		var sm_length = array_Compare2(draw_select_func,draw_direct_func);
		
		var result;
		if(check_package == "Controller"){
			result = draw_className.length+10;
		}else if(check_package == "Service"){
			result = draw_className.length+7;
		}else if(check_package == "DAO"){
			result = draw_className.length+3;
		}
		
		var c_length = Length_Compare(result, v_length + sv_length, m_length + sm_length);
		
		Connect_SavePoint(c_length,val_count, m_count);
		
		Value_List_Save();
		
		//Draw_AllList();
		//MVC_List_View();
		
		All_Init();
		
			}else{
		
			    Duplication_Check_Modify();
		Call_Value();
		
		/* test4 : 민섭 */
		var v_length = array_Compare(draw_valueName);
		var m_length = array_Compare(draw_methodName);
		var sv_length = array_Compare2(draw_select_val,draw_direct_val);
		var sm_length = array_Compare2(draw_select_func,draw_direct_func);
		
		var c_length = Length_Compare(draw_className.length, v_length + sv_length, m_length + sm_length);
		
		var c_length = Length_Compare(draw_className.length, v_length + sv_length, m_length + sm_length);
		Connect_SavePoint(c_length,val_count, m_count);
		
		
		Modify_Value_List_Save();
		
		//Draw_AllList();
		//MVC_List_View();
		
		All_Init();
			}
		}
		
		/**
		 * vo modal의 OK button이 눌렀을 때 발생하는 함수(vo)
		 */
		function VOOK(){
			if(!modify_vo_choice){
		Duplication_VO_Check();
		Call_VO_Value();
		Value_VOList_Save();
		
		//MVC_List_View();
		
		All_Init();
			}else{
		Duplication_Check_VO_Modify();
		Call_VO_Value();
		Modify_Value_VOList_Save();
		
		//MVC_List_View();
		
		All_Init();
			}
		}
		
		function DBOK(){
			db=new db_element();
			db.dbid = document.getElementById("dbid").value;
			db.dbpw = document.getElementById("dbpw").value;
			db.dbport = document.getElementById("dbport").value;
			db.dbsid = document.getElementById("dbsid").value;
			EmitDB();
		}
		
		
		function OnCancel(){
			All_Init();
		}
		
		
		
		
			//mouse_event.js
		/**
		 * canvas를 움직일 떄 사용할 때 움직일 class를 찾을 함수
		 */
		function MoveRectangle(x,y){
			// controllerList에서 움직일 class를 찾을 때...
			for (var i = 0;i < controllerList.length;i++) {
		var r = controllerList[i];
		if (x > r.start_point_x && x < r.end_point_x && y > r.start_point_y && y < r.end_point_y) {
			move_con = true;
			moving = i;
			break;
		}else{
			move_con = false;
		}
			}
			
			// serviceList에서 움직일 class를 찾을 때...
			for (var i = 0;i < serviceList.length;i++) {
		var r = serviceList[i];
		if (x > r.start_point_x && x < r.end_point_x && y > r.start_point_y && y < r.end_point_y) {
			move_ser = true;
			moving = i;
			break;
		}else{
			move_ser = false;
		}
			}
			
			// daoList에서 움직일 class를 찾을 때...
			for (var i = 0;i < daoList.length;i++) {
		var r = daoList[i];
		if (x > r.start_point_x && x < r.end_point_x && y > r.start_point_y && y < r.end_point_y) {
			move_dao = true;
			moving = i;
			break;
		}else{
			move_dao = false;
		}
			}
			
			if(move_con == false && move_ser == false && move_dao == false){
		moving = -1;
			}
		}
		
		/**
		 * 연결할 start class를 찾을 함수 
		 */
		function ConnectStart(x,y){
			for (var i = 0;i < controllerList.length;i++) {
		var r = controllerList[i];
		if (x > r.start_point_x && x < r.end_point_x && y > r.start_point_y && y < r.end_point_y) {
			btnconn_startcon = true;
			btnconn_startindex = i;
			break;
		}else{
			btnconn_startcon = false;
		}
			}
			
			// serviceList에서 움직일 class를 찾을 때...
			for (var i = 0;i < serviceList.length;i++) {
		var r = serviceList[i];
		if (x > r.start_point_x && x < r.end_point_x && y > r.start_point_y && y < r.end_point_y) {
			btnconn_startser = true;
			btnconn_startindex = i;
			break;
		}else{
			btnconn_startser = false;
		}
			}
			
			// daoList에서 움직일 class를 찾을 때...
			for (var i = 0;i < daoList.length;i++) {
		var r = daoList[i];
		if (x > r.start_point_x && x < r.end_point_x && y > r.start_point_y && y < r.end_point_y) {
			btnconn_startdao = true;
			btnconn_startindex = i;
			break;
		}else{
			btnconn_startdao = false;
		}
			}
			
			if(btnconn_startcon == false && btnconn_startser == false && btnconn_startdao == false){
		btnconn_startindex = -1;
			}
		}
		
		/**
		 * 연결할 end class를 찾을 함수 
		 */
		function ConnectEnd(x,y){
			for (var i = 0;i < controllerList.length;i++) {
		var r = controllerList[i];
		if (x > r.start_point_x && x < r.end_point_x && y > r.start_point_y && y < r.end_point_y) {
			btnconn_endcon = true;
			btnconn_endindex = i;
			break;
		}else{
			btnconn_endcon = false;
		}
			}
			
			// serviceList에서 움직일 class를 찾을 때...
			for (var i = 0;i < serviceList.length;i++) {
		var r = serviceList[i];
		if (x > r.start_point_x && x < r.end_point_x && y > r.start_point_y && y < r.end_point_y) {
			btnconn_endser = true;
			btnconn_endindex = i;
			break;
		}else{
			btnconn_endser = false;
		}
			}
			
			// daoList에서 움직일 class를 찾을 때...
			for (var i = 0;i < daoList.length;i++) {
		var r = daoList[i];
		if (x > r.start_point_x && x < r.end_point_x && y > r.start_point_y && y < r.end_point_y) {
			btnconn_enddao = true;
			btnconn_endindex = i;
			break;
		}else{
			btnconn_enddao = false;
		}
			}
			
			if(btnconn_endcon == false && btnconn_endser == false && btnconn_enddao == false){
		btnconn_endindex = -1;
			}
		}
		
		function MouseEventInit(){
			move_con = false;
			move_ser = false;
			move_dao = false;
			moving = -1;
			btnconn_startcon = false;
			btnconn_startser = false;
			btnconn_startdao = false;
			btnconn_startindex = -1;
			btnconn_endcon = false;
			btnconn_endser = false;
			btnconn_enddao = false;
			btnconn_endindex = -1;
			startList = "";
			endList = "";
		}
		
		
		
		
		
		
		
		
			//draw.js
		
		/**
		 * class를 그리기 위한 함수.
		 */

		function DrawClass(c_length) {
			var i=0;
			var j=0;

			context.font = '12pt Calibri';
			
			// class의 크기에 맞추어서 사각형을 그려줌.
			/* test4 : 민섭's 수정 */
			context.strokeRect(xpos, ypos, base_xpos + 3*c_length, base_ypos + 20*(cname_num + val_num) + 15*m_num);
			
			// classname 배열에 마지막에 저장된 class name을 출력
			context.fillText(draw_className, xpos + 10, ypos + 15 * cname_num);
			
		
			// 변수를 그려줌. **수정
			for (var i = 0; i < val_num; i++) {
		if(draw_valueName[i] != "" && draw_select_val[i] != "직접입력"){
			context.fillText(draw_select_val[i] + " " + draw_valueName[i], xpos+10, ypos+20 * cname_num + 15*(i+1));
		}else if(draw_valueName[i] != "" && draw_select_val[i] == "직접입력"){
			context.fillText(draw_direct_val[i] + " " + draw_valueName[i], xpos+10, ypos+20 * cname_num + 15*(i+1));
		}
			}
			
			// 메소드를 그려줌.
			for (var j = 0; j < m_num; j++) {
		if(draw_methodName[j] != "" && draw_select_func[j] != "직접입력"){
			context.fillText(draw_select_func[j] + " " + draw_methodName[j], xpos+10, ypos+20 * cname_num + 15*(i+1) + 15*(j+1));
		}else if(draw_methodName[j] != "" && draw_select_func[j] == "직접입력"){
			context.fillText(draw_direct_func[j] + " " + draw_methodName[j], xpos+10, ypos+20 * cname_num + 15*(i+1) + 15*(j+1));
		}
			}
			
			DrawLine();
		}
		
		/**
		 * class의 이름, 변수, 메서드 영역을 구별하기 위한 선을 그려주는 함수.
		 */
		 function DrawLine() {
			   context.beginPath();
			   context.moveTo(xpos, ypos + 20 * cname_num);
			   context.lineTo(width, ypos + 20 * cname_num);
		
			   if (val_num != 0) {
			      context.moveTo(xpos, 15 + ypos + 15*(val_num+1));
			      context.lineTo(width, 15 + ypos + 15*(val_num+1));
			   }
			   context.stroke();
		}
		
		/**
		 * class의 좌표를 이어주기 위한 함수. ( list에 저장하기 전에 DrawClass()를 사용하기 전에 사용.)
		 */
		
		function Connect_SavePoint(c_length, valNum, mNum){
			/* test4 : 민섭's */
			width = xpos + base_xpos + 3*c_length;
			height = ypos + base_ypos;
			
			end_xpos = width;
			end_ypos = height + 20*(1 + valNum) + 15*mNum;
		}
		/**
		 * class와 class를 연결해주는 선을 그리는 함수
		 */
		function DrawConnect(){
			
			context.beginPath();
			context.moveTo(xpos, ypos);
			context.lineTo(conn_point_X, conn_point_Y);
			context.stroke();
		}
		
		/**
		 * canvas의 내용을 전부 지움.
		 */
		function Erase_Canvas(){
			context.clearRect(0,0,1600,900);	
		}
		
		/**
		 * list의 모든 클래스들을 그려주는 함수.
		 */
		function Draw_AllList(){
			
			Erase_Canvas();
			
			context.beginPath();
			
			for(var i=0;i<controllerList.length;i++){
		
		draw_className = controllerList[i].classname;
		
		val_num = controllerList[i].valuename.length;
		m_num = controllerList[i].methodname.length;
		
		draw_valueName = controllerList[i].valuename;
		draw_methodName = controllerList[i].methodname;
		draw_select_val = controllerList[i].selectvalue;
		draw_select_func = controllerList[i].selectmethod;
		draw_direct_val = controllerList[i].directvalue;
		draw_direct_func = controllerList[i].directmethod;
		
		connectclass = controllerList[i].connclassname;
		
		xpos = controllerList[i].start_point_x;
		ypos = controllerList[i].start_point_y;
		
		/* test4 : 민섭 */
		var v_length = array_Compare(draw_valueName);
		var m_length = array_Compare(draw_methodName);
		var sv_length = array_Compare2(draw_select_val,draw_direct_val);
		var sm_length = array_Compare2(draw_select_func,draw_direct_func);
		
		var c_length = Length_Compare(draw_className.length, v_length + sv_length, m_length + sm_length);
		
		Connect_SavePoint(c_length,val_num, m_num);
		
		
		if(controllerList[i].connclassname != "init"){
		
			All_Draw_Connect_Line();
			DrawConnect();
			DrawClass(c_length);
		}else{
			DrawClass(c_length);
		}
		DrawInit();
			}
			
			for(var i=0;i<serviceList.length;i++){
		
		draw_className = serviceList[i].classname;
		
		val_num = serviceList[i].valuename.length;
		m_num = serviceList[i].methodname.length;
		draw_valueName = serviceList[i].valuename;
		draw_methodName = serviceList[i].methodname;
		draw_select_val = serviceList[i].selectvalue;
		draw_select_func = serviceList[i].selectmethod;
		draw_direct_val = serviceList[i].directvalue;
		draw_direct_func = serviceList[i].directmethod;
		
		connectclass = serviceList[i].connclassname;
		
		xpos = serviceList[i].start_point_x;
		ypos = serviceList[i].start_point_y;
		
		/* test4 : 민섭 */
		var v_length = array_Compare(draw_valueName);
		var m_length = array_Compare(draw_methodName);
		var sv_length = array_Compare2(draw_select_val,draw_direct_val);
		var sm_length = array_Compare2(draw_select_func,draw_direct_func);
		
		var c_length = Length_Compare(draw_className.length, v_length + sv_length, m_length + sm_length);
		
		Connect_SavePoint(c_length,val_num, m_num);
		
		if(serviceList[i].connclassname != "init"){
		
			All_Draw_Connect_Line();
			DrawConnect();
			DrawClass(c_length);
		}else{
			DrawClass(c_length);
		}
		DrawInit();
			}
			
			for(var i=0;i<daoList.length;i++){
		
		draw_className = daoList[i].classname;
		
		val_num = daoList[i].valuename.length;
		m_num = daoList[i].methodname.length;
		
		draw_valueName = daoList[i].valuename;
		draw_methodName = daoList[i].methodname;
		draw_select_val = daoList[i].selectvalue;
		draw_select_func = daoList[i].selectmethod;
		draw_direct_val = daoList[i].directvalue;
		draw_direct_func = daoList[i].directmethod;
		
		connectclass = daoList[i].connclassname;
		
		xpos = daoList[i].start_point_x;
		ypos = daoList[i].start_point_y;
			
		/* test4 : 민섭 */
		var v_length = array_Compare(draw_valueName);
		var m_length = array_Compare(draw_methodName);
		var sv_length = array_Compare2(draw_select_val,draw_direct_val);
		var sm_length = array_Compare2(draw_select_func,draw_direct_func);
		
		var c_length = Length_Compare(draw_className.length, v_length + sv_length, m_length + sm_length);
		
		Connect_SavePoint(c_length,val_num, m_num);
		
		if(daoList[i].connclassname != "init"){
		
			All_Draw_Connect_Line();
			DrawConnect();
			DrawClass(c_length);
		}else{
			DrawClass(c_length);
		}
		DrawInit();
			}
		
			context.rect(0, 0, 1600, 900);
			context.stroke();
			context.closePath();
			
		}
		
		// test4 error
		// 배열의 요소 길이를 리턴하는 함수
		function array_Compare(arr){
			
			var max_length = arr[0].length;
			
			for(var i=0;i<arr.length;i++){
				if(max_length <= arr[i].length){
					max_length = arr[i].length;
				}else{
					continue;
				}
			}
			
			return max_length;
		}

		/* test4 : 민섭 */
		function array_Compare2(arr1,arr2){

			var max_length = arr1[0].length;
			
			for(var i=0;i<arr1.length;i++){
				if(arr1[i] != "직접입력"){
					if(max_length <= arr1[i].length){
						max_length = arr1[i].length;
					}else{
						continue;
					}
				}else{
					if(max_length <= arr2[i].length){
						max_length = arr2[i].length;
					}else{
						continue;
					}
				}
			}
			
			return max_length;
		}
		
		/**
		 * input 태그에 입력한 값(class name, value name, method name)의 길이를 비교하기 위한 함수
		 */
		 /* test4 : 민섭 */
		function Length_Compare(n_length,v_length,m_length){
			if(n_length >= v_length){
				if(n_length >= m_length){
					return n_length;
				}else{
					return m_length;
				}
			}else{
				if(v_length >= m_length){
					return v_length;
				}else{
					return m_length;
				}
			}
		}
		
		/**
		 * 변수들을 초기화 해주는 함수.
		 */
		function DrawInit(){
			xpos = 0;
			ypos = 0;
			cname_num = 1;
			val_num = 0;
			m_num = 0;
			width = 0;
			height = 0;
			end_xpos = 0;
			end_ypos = 0;
			conn_point_X = 0;
			conn_point_Y = 0;
			
			draw_className = "";
			draw_valueName = [];
			draw_methodName = [];
			draw_select_val = [];
			draw_select_func = [];
			draw_direct_val = [];
			draw_direct_func = [];
		}
		     
		
		
		
		
		
		
		
			
		    $(document).ready(function(){		
				//버튼누르면 프로젝트파일생성하라고 서버에 emit 
				$('.create_file').click(function (){
						/* test5 : 민재 */
						socket.emit('createpj', {
						template:select_img		
		
					});
		         });
				//버튼누르면 sql문 파일생성하라고 서버에 emit 
				$('.create_sql').click(function (){
		                socket.emit('createtb');       // 소켓 이벤트 발생
		      	});
		
		        // 이벤트 연결
		
		        canvas.onmousedown = function(event){
			    context.beginPath();
			    
		        isDown = true;      // 눌렀다
		        point= new Point(event, this);      // 현재 마우스 위치를 기록
		            
			    xpos=point.x;
			    ypos=point.y;
		
			    if(isDown&&list_click&& !connect_btncheck){
		
					Dynamic_Connect_List();
					$("#myModal").modal();
					list_click = false;
		        }else if(!list_click && !connect_btncheck){		
					sx = xpos;
					sy = ypos;
			
					MoveRectangle(sx, sy);
			
				
					// 도형을 클릭한 것이 아니면 그리기 시작
					if (moving == -1) {
						drawing = true;
					}
			   		}else if(!list_click && connect_btncheck){
						conn_startX = xpos;
						conn_startY = ypos;
			
						ConnectStart(conn_startX,conn_startY);
			
					if(btnconn_startcon){
						startList = controllerList[btnconn_startindex];
						gubun=1;
			}else if(btnconn_startser){
				startList = serviceList[btnconn_startindex];
				gubun=2;
			}else if(btnconn_startdao){
				startList = daoList[btnconn_startindex];
				gubun=3;
			}
			
		}
		
			context.stroke();
		
		        };
		
		        canvas.onmouseup = function(){ isDown = false; drawing = false;
		    	$("#canvas1").css('cursor', 'auto');
		
		moving = -1;
		point= new Point(event, this);      // 현재 마우스 위치를 기록
		            	context.beginPath();
			    	xpos=point.x;
			    	ypos=point.y;
			
			//@수정
			if(!list_click){
			ex = xpos;
			ey = ypos;
			
			if (temp_moving != -1) {
				
				if(move_con){
					gubun=1;
					EmitMoveCanvas();
					
					//Draw_AllList();
				}else if(move_ser){
					gubun=2;
					EmitMoveCanvas();
					//r.start_point_x += (ex - sx);
					//r.start_point_y += (ey - sy);
					//r.end_point_x = r.start_point_x + gap_x;
					//r.end_point_y = r.start_point_y + gap_y;
				
					//Draw_AllList();
				}else if(move_dao){
					gubun=3;
					EmitMoveCanvas();
					//r.start_point_x += (ex - sx);
					//r.start_point_y += (ey - sy);
					//r.end_point_x = r.start_point_x + gap_x;
					//r.end_point_y = r.start_point_y + gap_y;
					
					//Draw_AllList();
				}
			}
		}
		//여기까지수정
		if(!list_click && connect_btncheck){
			conn_endX = xpos;
			conn_endY = ypos;
			
			ConnectEnd(conn_endX,conn_endY);
			
			if(btnconn_endcon){
				endList = controllerList[btnconn_endindex];
			
			}else if(btnconn_endser){
				
				endList = serviceList[btnconn_endindex];
				
			}else if(btnconn_enddao){
				endList = daoList[btnconn_endindex];
			}
			
			//startList.connclassname = endList.classname;
			//Draw_AllList();
			EmitConn();
			
		}
		connect_btncheck = false;
		All_Init();
		context.stroke();
		
			};
		
		        canvas.onmousemove = function(event) {
		point= new Point(event, this);      // 현재 마우스 위치를 기록
			    	xpos=point.x;
			   	ypos=point.y;
		
		
		           isDown =true;
			
		
			if(!list_click){
			ex = xpos;
			ey = ypos;
			
			if (moving != -1) {
				
				if(move_con){
				$(canvas).css('cursor', 'move');
					r = controllerList[moving];
					
					temp_moving=moving
					gap_x = r.end_point_x - r.start_point_x;
					gap_y = r.end_point_y - r.start_point_y;
					
		
					r.start_point_x += (ex - sx);
					
					r.start_point_y += (ey - sy);
					
					r.end_point_x = r.start_point_x + gap_x;
					r.end_point_y = r.start_point_y + gap_y;
					sx = ex;
					sy = ey;
					temp_r=r;
					Draw_AllList();
					
					move_con=true;
				}else if(move_ser){
				$(canvas).css('cursor', 'move');
					r = serviceList[moving];
					
					temp_moving=moving
					gap_x = r.end_point_x - r.start_point_x;
					temp_gap_x=gap_x;
					gap_y = r.end_point_y - r.start_point_y;
					temp_gap_y=gap_y;
		
					r.start_point_x += (ex - sx);
					temp_ex=ex;
					temp_sx=sx;
					r.start_point_y += (ey - sy);
					temp_ey=ey;
					temp_sy=sy;
					r.end_point_x = r.start_point_x + gap_x;
					r.end_point_y = r.start_point_y + gap_y;
					sx = ex;
					sy = ey;
					temp_r=r;
					Draw_AllList();
					move_ser=true;
				}else if(move_dao){
				$(canvas).css('cursor', 'move');
					r = daoList[moving];
					
					temp_moving=moving
					gap_x = r.end_point_x - r.start_point_x;
					temp_gap_x=gap_x;
					gap_y = r.end_point_y - r.start_point_y;
					temp_gap_y=gap_y;
		
					r.start_point_x += (ex - sx);
					temp_ex=ex;
					temp_sx=sx;
					r.start_point_y += (ey - sy);
					temp_ey=ey;
					temp_sy=sy;
					r.end_point_x = r.start_point_x + gap_x;
					r.end_point_y = r.start_point_y + gap_y;
		
					sx = ex;
					sy = ey;
					temp_r=r;
					Draw_AllList();
					move_dao=true;
				
				}
			}
		}
		
		        };
		
		
		// 캔버스 안에 그려줄 화면 크기
		context.beginPath();
		context.rect(0, 0, 1200, 1200);
		context.stroke();
		
		
		
		
		/**
		 * select value값이 직접입력일 경우 input의 type을 text로 바꾸어주는 jquery... mvc.js
		 */
		// document의 동적으로 생성된 이벤트 붙이기...
		// on()의 매개변수 : 발생할 이벤트, 붙일 요소, 이벤트 핸들러

$(document).on('change', '.select_value', function(){
    if( $(this).val() == '직접입력') {
       var index = $(this).attr("id").substring(12);
       $("#direct_input_val"+index).attr("type","text");
    }
    else{
       var index = $(this).attr("id").substring(12);
       $("#direct_input_val"+index).attr("type","hidden");
       $("#direct_input_val"+index).val("");
    }
});
$(document).on('change', '.select_method', function(){
    if( $(this).val() == '직접입력') {
       var index = $(this).attr("id").substring(13);
       $("#direct_input_func"+index).attr("type","text");
    }else{
       var index = $(this).attr("id").substring(13);
       $("#direct_input_func"+index).attr("type","hidden");
       $("#direct_input_func"+index).val("");
    }
});
		  
		//서버에서 이미 그려진 캔버스데이터
		//나중에 함수로..
		
		<% var m=0;
		  var n=0;
		
		if(canvaslist.length==0&& creator){%>   //방생성자면 
		//기본 mvc클래스 그려주기
		
			context.beginPath();
			var temp=[];
			temp[0]="";
			//mvc.js   
			// controller의 값들을 변수에 저장.
			controller = new element();
			gubun=1;
			xpos = 50;
			ypos = 50;
		                                   
		    c_name = "Exam";
			draw_className = c_name+"Controller";
			connectclass = "init";
			
			// test4 error
			/* test4 : 민섭 */
			var v_length = 0;
			var m_length = 0;
			var sv_length = 0;
			var sm_length = 0;
			
			var c_length = Length_Compare(draw_className.length, v_length + sv_length, m_length + sm_length);
			
			Connect_SavePoint(c_length,temp.length, temp.length);
			// element에 초기값을 저장함.
			
			controller.classname = draw_className;
			controller.valuename = temp;
			controller.methodname = temp;
			controller.selectvalue = temp;
			controller.selectmethod = temp;
			controller.directvalue = temp;
			controller.directmethod = temp;
			controller.connclassname = connectclass;
			controller.start_point_x = xpos;
			controller.start_point_y = ypos;
			controller.end_point_x = end_xpos;
			controller.end_point_y = end_ypos;
			
			
			//controllerList[con_cnt] = controller;
			//con_cnt++;
			EmitCanvas(gubun);
			
		
		
		
			service = new element();
			gubun=2;
			xpos = 250;
			ypos = 250;
		                             
			draw_className = c_name+"Service";
		                                   
			val_num  = draw_valueName.length;
			draw_methodName[0] = "method1";
			draw_methodName[1] = "method2";
			draw_select_func[0] = "void";
			draw_select_func[1] = "int";
			draw_direct_func[0] = "";
			draw_direct_func[1] = "";
			m_num  = draw_methodName.length;
			connectclass = "ExamController";
			
			/* test4 : 민섭 */
			var v_length = 0;
			var m_length = array_Compare(draw_methodName);
			var sv_length = 0;
			var sm_length = array_Compare2(draw_select_func,draw_direct_func);
			
			var c_length = Length_Compare(draw_className.length, v_length + sv_length, m_length + sm_length);
			
			Connect_SavePoint(c_length,temp.length, draw_methodName.length);
		
			service.classname = draw_className;
			service.valuename = temp;
			service.methodname = draw_methodName;
			service.selectvalue = temp;
			service.selectmethod = draw_select_func;
			service.directvalue = temp;
			service.directmethod = draw_direct_func;
			service.connclassname = connectclass;
			service.start_point_x = xpos;
			service.start_point_y = ypos;
			service.end_point_x = end_xpos;
			service.end_point_y = end_ypos;
			
			//serviceList[0] = service;
			check_package = "Controller";
			EmitCanvas(gubun);
			index = 0;
		
			//ser_cnt++;
			dao = new element();
			gubun=3;
			xpos = 450;
			ypos = 450;
		                                   
			draw_className = c_name+"DAO";
		                                   
			draw_valueName[0] = "value1";
			draw_valueName[1] = "value2";
			draw_select_val[0] = "int";
			draw_select_val[1] = "String";
			draw_direct_val[0] = "";
			draw_direct_val[1] = "";
			val_num  = draw_valueName.length;
			draw_methodName[0] = "method1";
			draw_methodName[1] = "method2";
			draw_select_func [0] = "void";
			draw_select_func [1] = "int";
			draw_direct_func[0] = "";
			draw_direct_func[1] = "";
			m_num  = draw_methodName.length;
			connectclass = "ExamService";
			
			/* test4 : 민섭 */
			var v_length = array_Compare(draw_valueName);
			var m_length = array_Compare(draw_methodName);
			var sv_length = array_Compare2(draw_select_val,draw_direct_val);
			var sm_length = array_Compare2(draw_select_func,draw_direct_func);
			
			var c_length = Length_Compare(draw_className.length, v_length + sv_length, m_length + sm_length);
			
			Connect_SavePoint(c_length,val_num, m_num);
		
			
			dao.classname = draw_className;
			dao.valuename = draw_valueName;
			dao.methodname = draw_methodName;
			dao.selectvalue = draw_select_val;
			dao.selectmethod = draw_select_func;
			dao.directvalue = draw_direct_val;
			dao.directmethod = draw_direct_func;
			dao.connclassname = connectclass;
			dao.start_point_x = xpos;
			dao.start_point_y = ypos;
			dao.end_point_x = end_xpos;
			dao.end_point_y = end_ypos;
			
			//daoList[0] = dao;
			EmitCanvas(gubun);
			check_package = "Service";
			index = 0;
		
			//dao_cnt++;
			
			context.beginPath();
			
			// 캔버스 안에 그려줄 화면 크기
			context.rect(0, 0, 1200, 1200);
			
			//Draw_AllList();
			
			context.stroke();
		
			context.closePath();
			
			MVC_List_View();
			
			All_Init();
			
		
		
		<%}else{%>
			
			db=<%- JSON.stringify(db)%>;
			<%for(var k=0; k<canvaslist.length;k++){
		if(canvaslist[k].gb==1){%>
			controllerList[con_cnt] =  <%- JSON.stringify(canvaslist[k].class)%>;		
			con_cnt++;
		<%}else if(canvaslist[k].gb==2){%>
			serviceList[ser_cnt] = <%- JSON.stringify(canvaslist[k].class)%>;		
			ser_cnt++;
		<%}else if(canvaslist[k].gb==3){%>
			daoList[dao_cnt] = <%- JSON.stringify(canvaslist[k].class)%>;			
			dao_cnt++;
		<%}else if(canvaslist[k].gb==4){%>
			voList[vo_cnt] = <%- JSON.stringify(canvaslist[k].class)%>;			
			vo_cnt++;
		<%}%>
			
		       	 
		context.beginPath();
		            
			
		Draw_AllList();
			
		context.stroke();
		
		MVC_List_View();
			
		<%	}
		}%>
		
		
		//여기까지 이미 작성된 캔버스 그려주기.
			
		
		
		
		
		//db정보 저장
		     socket.on('db', function(data){
			
			
		db=data.db;
		
		        });
			
		
		//캔버스 그려주기
		     socket.on('line', function(data){
			
			if(data.gb==1){
		controllerList[con_cnt] = data.class;			
		con_cnt++;
			}else if(data.gb==2){
		serviceList[ser_cnt] = data.class;			
		ser_cnt++;
			}else if(data.gb==3){
		daoList[dao_cnt] = data.class;			
		dao_cnt++;
			}else if(data.gb==4){
		voList[vo_cnt] = data.class;
		vo_cnt++;
			}
			
			
		        //context.strokeStyle = data.color;
			context.beginPath();
		            
			Draw_AllList();
			
			
			context.stroke();
		
			MVC_List_View();
			
			All_Init();
		
		        });
		
		
		//수정된 캔버스 그려주기
		     socket.on('mod_line', function(data){
		
			// 연결된 class 이름을 바꾸어주는 함수.
			function mod_conn(conn_c){
		if(conn_c.m_conn_gb==1){
			controllerList[conn_c.m_conn_idx].connclassname=data.class.classname;
			/* alert('연결바꿀클래스'+controllerList[conn_c.m_conn_idx].classname+'연결된거바꾸는 이름:'+data.class.classname); */
		}else if(conn_c.m_conn_gb==2){
			serviceList[conn_c.m_conn_idx].connclassname=data.class.classname;
			/* alert('연결바꿀클래스'+serviceList[conn_c.m_conn_idx].classname+'연결된거바꾸는 이름:'+data.class.classname); */
		}else if(conn_c.m_conn_gb==3){
			daoList[conn_c.m_conn_idx].connclassname=data.class.classname;
			/* alert('연결바꿀클래스'+daoList[conn_c.m_conn_idx].classname+'연결된거바꾸는 이름:'+data.class.classname); */
		}
		
			}
			if(data.gb==1){
		controllerList[data.m_idx] = data.class;
					
		
			}else if(data.gb==2){
		serviceList[data.m_idx] = data.class;		
		
			}else if(data.gb==3){
		daoList[data.m_idx] = data.class;			
		
			}else if(data.gb==4){
		voList[data.m_idx]=data.class;
			}
			if(data.gb!=4){
		for(var i=0;i<data.m_conn_list.length; i++){
			mod_conn(data.m_conn_list[i]);
		}
			}
			
		        //context.strokeStyle = data.color;
			context.beginPath();
		            
			Draw_AllList();
			
			
			context.stroke();
		
			MVC_List_View();
			
			All_Init();
		
		        });
		        
		
		
		//삭제후 캔버스 그려주기
		     socket.on('del_line', function(data){
		
			// 연결된 class 이름을 "init"으로 바꾸어주는 함수.
			function del_conn(conn_c){
		if(conn_c.d_conn_gb==1){
			controllerList[conn_c.d_conn_idx].connclassname="init";
		}else if(conn_c.d_conn_gb==2){
			serviceList[conn_c.d_conn_idx].connclassname="init";
		}else if(conn_c.d_conn_gb==3){
			daoList[conn_c.d_conn_idx].connclassname="init";
		}
		
			}
			if(data.gb==1){
		controllerList.splice(data.d_idx,1);
		if(con_cnt > 0){
			con_cnt--;
		}
					
		
			}else if(data.gb==2){
		serviceList.splice(data.d_idx,1);	
		if(ser_cnt > 0){
			ser_cnt--;
		}	
		
			}else if(data.gb==3){
		daoList.splice(data.d_idx,1);
		if(dao_cnt > 0){
			dao_cnt--;
		}			
		
			}else if(data.gb==4){
		voList.splice(data.d_idx,1);
		if(vo_cnt > 0){
			vo_cnt--;
		}	
			}
		
			if(data.gb!=4){
		for(var i=0;i<data.d_conn_list.length; i++){
			del_conn(data.d_conn_list[i]);
		}
			}
			
		        //context.strokeStyle = data.color;
			context.beginPath();
		        
			Erase_Canvas();    
			Draw_AllList();
			
			
			context.stroke();
		
			MVC_List_View();
			
			
			All_Init();
		
		        });
		
			//move한 캔버스 그려주기
		     socket.on('move_line', function(data){
		
			
			if(data.gb==1){
		var r=controllerList[data.mv_idx] ;
		r.start_point_x = data.start_x;
		r.start_point_y = data.start_y;
		r.end_point_x = data.end_x;
		r.end_point_y = data.end_y;
		
					
		
			}else if(data.gb==2){
		var r=serviceList[data.mv_idx];	
		r.start_point_x = data.start_x;
		r.start_point_y = data.start_y;
		r.end_point_x = data.end_x;
		r.end_point_y = data.end_y;
		
			}else if(data.gb==3){
		var r=daoList[data.mv_idx];
		r.start_point_x = data.start_x;
		r.start_point_y = data.start_y;
		r.end_point_x = data.end_x;
		r.end_point_y = data.end_y;	
		
			}
		
			
		        //context.strokeStyle = data.color;
			context.beginPath();
		            
			Draw_AllList();
			
			
			context.stroke();
		
			All_Init();
		
		        });
		
		
			
		//수정된 연결 정보 그려주기
		     socket.on('conn_line', function(data){
			
			if(data.gb==1){
		controllerList[data.start_idx].connclassname= data.endClass.classname;
			}else if(data.gb==2){
		serviceList[data.start_idx].connclassname= data.endClass.classname;
			}else if(data.gb==3){
		daoList[data.start_idx].connclassname= data.endClass.classname;
			}
			
		        //context.strokeStyle = data.color;
			
			context.beginPath();
		            
			Draw_AllList();
			
			
			context.stroke();
		
		
			
			All_Init();
		
		        });
		        
		
		        
		        
		
		
		    });
		
		
		
		    </script>
-->

<script>

//draw한 table 정보들 emit해주는 함수
function EmitTable(){
	
	socket.emit('draw_table', {
		
		table:table			
			
	});
	
	
}

//수정한 table 정보들 emit해주는 함수
function EmitModifyTable(){

		socket.emit('modifyTable', {
			m_class:modify_table,
			m_idx:modify_dbindex,
			table:table	
			
		});
	
}



//move한 table정보들 emit해주는 함수
function EmitMoveTable(){
	
	socket.emit('moveTable', {
			mv_table:temp_r,
			mv_idx:temp_tb_moving,
			start_x:temp_r.start_point_dbx,
			start_y:temp_r.start_point_dby,
			end_x:temp_r.end_point_dbx,
			end_y:temp_r.end_point_dby,
			
	});
	
}

//삭제한 table정보들 emit해주는 함수
function EmitDeleteTable(){
	
	
		socket.emit('deleteTable', {
		
			d_class:delete_table,
			d_idx:delete_dbindex
			
			
		});
	
}

/* DB db.js */     
     
var canvas2 = document.getElementById("canvas2");
var context2 = canvas2.getContext("2d");

//서버에서 이미 그려진 테이블데이터
<%

if(tablelist.length==0&& creator){%>   //방생성자면 
//기본 mvc클래스 그려주기

	context2.beginPath();
	var temp=[];
	
		 
	 // 공통으로 들어갈 초기값.
   draw_columnName[0] = "NAME";
   draw_columnName[1] = "AGE";
   draw_dataType[0] = "VARCHAR2";
   draw_dataType[1] = "NUMBER";
   draw_direct_type[0] = "";
   draw_direct_type[1] = "";
   draw_conn_dao="init";
   comn_num = draw_columnName.length;
      
   // table의 값들을 변수에 저장.
   db_xpos = 50;
   db_ypos = 50;
   draw_className = "USERS";
   
   /* test4 : 민섭*/
	var v_length = array_Compare(draw_columnName);
	var sv_length = array_Compare2(draw_dataType,draw_direct_type);
	   
	var c_length = Length_Compare(draw_tableName.length, v_length + sv_length,0);
	   
	DB_Connect_SavePoint(c_length,comn_num);


   // element에 초기값을 저장함.
   table = new db_element();
   table.tablename = draw_className;
   table.columnname = draw_columnName;
   table.datatype = draw_dataType;
   table.directtype = draw_direct_type;
   table.conn_dao=draw_conn_dao;
   table.start_point_dbx = db_xpos;
   table.start_point_dby = db_ypos;
   table.end_point_dbx = end_db_xpos;
   table.end_point_dby = end_db_ypos;
   
	
	//tableList[table_cnt] = table;
    //table_cnt++;
	
	EmitTable();
	



	
	
	context2.beginPath();
	
	// 캔버스 안에 그려줄 화면 크기
	context2.rect(0, 0, 1200, 1200);
	
	//DB_Draw_AllList();
	
	context2.stroke();

	context2.closePath();
	
	//DB_List_View();
	
	//DB_All_Init();
	


<%}else{%>
	
	
	<%for(var kk=0; kk<tablelist.length;kk++){%>
			tableList[table_cnt] =  <%- JSON.stringify(tablelist[kk])%>;		
			table_cnt++;
		
	
       	 
		context2.beginPath();
            
	
		DB_Draw_AllList();
	
		context2.stroke();

		DB_List_View();
	
<%	}
}%>


//여기까지 이미 작성된 테이블 그려주기.
	


window.onload = function() {
	
   // 모든 event를 등록하는 곳.
   list_click_db = false;
   
   $("#crea_table").click(function(){
      list_click_db = true;
   });
   $("#canvas2").mousedown(function(){
      if(list_click_db){
         db_xpos = canvas2X(event.clientX);
         db_ypos = canvas2Y(event.clientY);
		 DB_Connect_DAOList();
         $("#tableModal").modal();
         list_click_db = false;
      }else if(!list_click_db){
         //console.log("mousedown x : " + db_xpos + " / y : " + db_ypos);
         db_sx = canvas2X(event.clientX);
         db_sy = canvas2Y(event.clientY);
         
         DBMoveRectangle(db_sx, db_sy);
      }
   });
   $("#canvas2").mousemove(function(){
	      if(!list_click_db){
	         db_ex = canvas2X(event.clientX);
	         db_ey = canvas2Y(event.clientY);
	         
	         if (table_moving != -1) {
                 
	            if(move_table){
                    $("#canvas2").css('cursor', 'move');
	               r = tableList[table_moving];
				   temp_tb_moving=table_moving;
	               var gap_x = r.end_point_dbx - r.start_point_dbx;
	               var gap_y = r.end_point_dby - r.start_point_dby;
	               r.start_point_dbx += (db_ex - db_sx);
	               r.start_point_dby += (db_ey - db_sy);
	               r.end_point_dbx = r.start_point_dbx + gap_x;
	               r.end_point_dby = r.start_point_dby + gap_y;
	               db_sx = db_ex;
	               db_sy = db_ey;
				   temp_r=r;
	               DB_Draw_AllList();
					move_table=true;
	            }
	         }
	      }
	   });
   $("#canvas2").mouseup(function(){

    		$("#canvas2").css('cursor', 'auto');
      if(!list_click_db){
          
         DB_Draw_AllList();
      }
	  if(temp_tb_moving != -1){
				
				if(move_table){

				$(canvas).css('cursor', 'move');
					
					EmitMoveTable();
					
					//Draw_AllList();
				
			}
		}	 
      DB_All_Init();
   });
   /* test4 : 민섭's */
   $("#classname").bind("keyup",function(){
		var classname = $("#classname").val();
		var ss = /[`~!@\#%<>^&*\()\-=+\'\s";:\\|\{},.]/gi;
		var fn = /[0-9]/gi;
		
		if(classname.length == 1){
			if(ss.test(classname)){
				$("#classname").val(classname.replace(ss,""));
			}else if(fn.test(classname)){
				$("#classname").val(classname.replace(fn,""));
			}
		}else{
			if(ss.test(classname)){ //특수문자가 포함되면 삭제하여 값으로 다시셋팅
				$("#classname").val(classname.replace(ss,""));
			}
		}
	});/* test4 : 민섭 */
   	$("#tablename").bind("keyup",function(){
	      var tablename = $("#tablename").val();
	      var ss = /[`~!@\$#%<>^&*\()\-=+\_'\s";:\\|\{},.]/gi;
	      var sw = /[`~!@\%<>^&*\()\-=+\'\s";:\\|\{},.]/gi;
	      
	      if(tablename.length == 1){
	         if(ss.test(tablename)){
	            $("#tablename").val(tablename.replace(ss,""));
	         }
	      }else{
	         if(sw.test(tablename)){ //특수문자가 포함되면 삭제하여 값으로 다시셋팅
	            $("#tablename").val(tablename.replace(sw,""));
	         }
	      }
	   });

	

}

$(document).on("keyup",".valuename",function(){
	var index = $(this).attr("id").substring(9);
	var valuename = $(this).val();
	var ss = /[`~!@\#%<>^&*\()\-=+\'\s";:\\|\{},.]/gi;
	var fn = /[0-9]/gi;
	
	if(valuename.length == 1){
		if(ss.test(valuename)){
			$("#valuename" + index).val(valuename.replace(ss,""));
		}else if(fn.test(valuename)){
			$("#valuename" + index).val(valuename.replace(fn,""));
		}
	}else{
		if(ss.test(valuename)){ //특수문자가 포함되면 삭제하여 값으로 다시셋팅
			$("#valuename" + index).val(valuename.replace(ss,""));
		}
	}
});



/* test4 : 민섭 */
$(document).on("keyup",".methodname",function(){
	var index = $(this).attr("id").substring(10);
	var methodname = $(this).val();
	var ss = /[`~!@\#%<>^&*\()\-=+\'\s";:\\|\{},.]/gi;
	var fn = /[0-9]/gi;
	
	if(methodname.length == 1){
		if(ss.test(methodname)){
			$("#methodname" + index).val(methodname.replace(ss,""));
		}else if(fn.test(methodname)){
			$("#methodname" + index).val(methodname.replace(fn,""));
		}
	}else{
		if(ss.test(methodname)){ //특수문자가 포함되면 삭제하여 값으로 다시셋팅
			$("#methodname" + index).val(methodname.replace(ss,""));
		}
	}
});
/* test4 : 민섭 */
$(document).on("keyup",".column_name",function(){
	   var index = $(this).attr("id").substring(11);
	   var column_name = $(this).val();
	   var ss = /[`~!@\$#%<>^&*\()\-=+\_'\s";:\\|\{},.]/gi;
	   var sw = /[`~!@\%<>^&*\()\-=+\'\s";:\\|\{},.]/gi;
	   
	   if(column_name.length == 1){
	      if(ss.test(column_name)){
	         $("#column_name" + index).val(column_name.replace(ss,""));
	      }
	   }else{
	      if(sw.test(column_name)){ //특수문자가 포함되면 삭제하여 값으로 다시셋팅
	         $("#column_name" + index).val(column_name.replace(sw,""));
	      }
	   }
	});


/**
 * select value값이 직접입력일 경우 input의 type을 text로 바꾸어주는 jquery
 */
// document의 동적으로 생성된 이벤트 붙이기...
// on()의 매개변수 : 발생할 이벤트, 붙일 요소, 이벤트 핸들러

$(document).on('change', '.select_datatype', function(){
    if( $(this).val() == '직접입력') {
       var index = $(this).attr("id").substring(15);
       $("#direct_column"+index).attr("type","text");
    }
    else{
       var index = $(this).attr("id").substring(15);
       $("#direct_column"+index).attr("type","hidden");
       $("#direct_column"+index).val("");
    }
});

/**
 * canvas의 정확한 좌표를 구해오기 위한 계산 함수
 */
function canvas2X(clientX) {
    var bound = canvas2.getBoundingClientRect();
    return (clientX - bound.left) * (canvas2.width / bound.width);
}

function canvas2Y(clientY) {
    var bound = canvas2.getBoundingClientRect();
    return (clientY - bound.top) * (canvas2.height / bound.height);
}
   
/* 여기까지 */   
   
   


/* DB db_modal.js */
/**
 * 각 input box의 id값을 가져와서 배열에 저장하고 canvas를 그려주는 함수. modal창의 ok button을 누르면 실행됨.*/

 function TableOK() {
		
		if(!modify_dbchoice){

			Duplication_DB_Check();
			Call_DB_Value();
			
			 /* test4 : 민섭*/
			var v_length = array_Compare(draw_columnName);
			var sv_length = array_Compare2(draw_dataType,draw_direct_type);
			   
		 	var c_length = Length_Compare(draw_tableName.length, v_length + sv_length,0);
			
			DB_Connect_SavePoint(c_length,comn_count);
			
			Value_TableList_Save();
			
			//DB_Draw_AllList();
			//DB_List_View();
			
			DB_All_Init();
			
		}else{

			Duplication_Check_DB_Modify();
			Call_DB_Value();
			
			/* test4 : 민섭*/
			var v_length = array_Compare(draw_columnName);
			var sv_length = array_Compare2(draw_dataType,draw_direct_type);
			   
		 	var c_length = Length_Compare(draw_tableName.length, v_length + sv_length,0);
			
			DB_Connect_SavePoint(c_length,comn_count);

			Modify_Value_DBList_Save();
			
			//DB_Draw_AllList();
			//DB_List_View();
			
			DB_All_Init();
		}
	}

function DBCancel(){ 
   DB_All_Init();
}
/* 여기까지 */      
        
        
        
 

/* DB db_modal_create.js */
/**
 * List들을 순회하면서 table의 name들이 곂치는지 확인하기 위한 함수.
 */
function Duplication_DB_Check(){
   if(tableList.length != 0){
      for(var i=0;i<tableList.length;i++){
         if(tableList[i].tablename != document.getElementById("tablename").value){
            t_name = document.getElementById("tablename").value;
            check_tname = true;
         }else{
            alert("Table의 Name이 중복 됩니다.");
            check_tname = false;
            break;
         }
      }
   }else{
      t_name = document.getElementById("tablename").value;
      check_tname = true;
   }
}

/**
 * document의 input tag에 저장되어 있는 값들을 불러오는 함수.(db)
 */
function Call_DB_Value(){
   // 중복된 class의 이름이 없으면 document의 값을 받아와 배열에 저장
   if(check_tname == true){
      
      draw_tableName = t_name;
      draw_conn_dao= document.getElementById("connect_dao").value;
      for(var i=0; i<comn_count; i++){
         column_name[i] = document.getElementById("column_name"+i);
         select_type[i] = document.getElementById("select_datatype"+i);
         direct_type[i] = document.getElementById("direct_column"+i);
      }
      
      for(var j=0; j<comn_count; j++){
         draw_columnName[j] = column_name[j].value;
         draw_dataType[j] = select_type[j].value;
         draw_direct_type[j] = direct_type[j].value;
      }
   }
}

/**
 * document에서 받아온 값들을 list에 저장하는 함수(vo)
 */
function Value_TableList_Save(){
   if(check_tname == true && t_name != ""){
      
      table = new db_element();
      table.tablename = t_name;
      table.columnname = draw_columnName;
      table.datatype = draw_dataType;
      table.directtype = draw_direct_type;
	  table.conn_dao=draw_conn_dao;
      table.start_point_dbx = db_xpos;
      table.start_point_dby = db_ypos;
      table.end_point_dbx = end_db_xpos;
      table.end_point_dby = end_db_ypos;
      
      //tableList[table_cnt] = table;
         
      //table_cnt++;
	  EmitTable();
   }
}

function DBValuesInit(){
   t_name = "";
   column_name = [];
   select_type = [];
   direct_type = [];
   
   check_tname = false;
}
/* 여기까지 */
        

/* db_modal_delete */
/**
 * 삭제 button을 눌렀을 때 호출되는 함수.
 */
function DBList_Delete(a){
   
   delete_table = a;
   Search_DBList_Delete();
   
   if(delete_db){
	   EmitDeleteTable();
	   /*
      tableList.splice(delete_dbindex,1);
      if(table_cnt > 0){
         table_cnt--;
      }*/
   }
   
   //DB_Erase_Canvas();
  // DB_Draw_AllList();
   
   //DB_List_View();
   
   DB_All_Init();
}

/**
 * 삭제할 index를 찾는 함수.
 */
function Search_DBList_Delete(){
   // controllerList 탐색
   for(var i=0;i<tableList.length;i++){
      if(delete_table == tableList[i].tablename){
         delete_dbindex = i;
         delete_db = true;
         break;
      }else{
         delete_db = false;
      }
   }
}

/**
 * 사용한 값들을 초기화하는 함수.
 */
function DeleteDBInit(){
   delete_table = "";
   delete_db = false;
   delete_ser = false;
   delete_dao = false;
   delete_dbindex = -1;
}

/* 여기까지 */


/*  DB db_modal_modify.js */
/**
 * 수정 button을 눌렀을 떄 호출되는 함수.
 */
function DBList_Modify(a){
   
   modify_table = a;
   
   modify_dbchoice = true;
   Search_DBList_Modify();
   
   if(modify_db){   
      
      document.getElementById("tablename").value = tableList[modify_dbindex].tablename;
      // value와 method의 개수만큼 form을 늘려줌. 
      for(var i=1;i<tableList[modify_dbindex].columnname.length;i++){
         AddColumnForm();
      }

      // form의 값을 설정해줌
      for(var i=0; i<comn_count; i++){
         document.getElementById("column_name"+i).value = tableList[modify_dbindex].columnname[i];
         document.getElementById("select_datatype"+i).value = tableList[modify_dbindex].datatype[i];
         document.getElementById("direct_column"+i).value = tableList[modify_dbindex].directtype[i];
         
         if(tableList[modify_dbindex].datatype[i] == "직접입력"){
            $("#direct_column"+i).attr("type","text");
         }
      }

	  
      db_xpos = tableList[modify_dbindex].start_point_dbx;
      db_ypos = tableList[modify_dbindex].start_point_dby;
	  DB_Connect_DAOList();
	  document.getElementById("connect_dao").value = tableList[modify_dbindex].conn_dao;
      // modal창을 불러옴
      $(document).ready(function(){
         $("#tableModal").modal();
      });
      
   }
}

/**
 * 수정을 위한 탐색 함수
 */
function Search_DBList_Modify(){
   
   // tableList 탐색
   for(var i=0;i<tableList.length;i++){
      if(modify_table == tableList[i].tablename){
         modify_dbindex = i;
         modify_db = true;
         break;
      }else{
         modify_db = false;
      }
   }
}

/**
 * 수정할 때 tablename이 중복되지 않게 check하기 위한 함수.
 */
function Duplication_Check_DB_Modify(){
   for(var i=0;i<tableList.length;i++){
      if(tableList[i].tablename != document.getElementById("tablename").value){
         t_name = document.getElementById("tablename").value;
         check_tname = true;
         break;
      }else{
         if(modify_dbindex == i){
            t_name = document.getElementById("tablename").value;
            check_tname = true;
            break;
         }else{
            alert("Table의 Name이 중복 됩니다.");
            check_tname = false;
            break;
         }
      }
   }
}

/**
 * 수정된 값을 tablelist에 저장하는 함수.
 */
function Modify_Value_DBList_Save(){
   if(check_tname == true && t_name != ""){
      
      table = new db_element();
      table.tablename = t_name;
      table.columnname = draw_columnName;
      table.datatype = draw_dataType;
      table.directtype = draw_direct_type;
      table.start_point_dbx = tableList[modify_dbindex].start_point_dbx;
      table.start_point_dby = tableList[modify_dbindex].start_point_dby;
      table.end_point_dbx = end_db_xpos;
      table.end_point_dby = end_db_ypos;
      table.conn_dao=draw_conn_dao;
      
	  EmitModifyTable();
      //tableList[modify_dbindex] = table;
   }
}


function ModifyDBInit(){
   modify_table = "";
   modify_db = false;
   modify_dbindex = -1;
   modify_dbchoice = false;
}

/*  여기까지 */



/*DB dynamic_form.js */

/**
 * value form을 하나하나 증가시켜주는 함수
 */
function AddColumnForm() {
   var addedComnFormDiv = document.getElementById("tableDiv");
   var str = "Column";/* test4 : 민섭 */
   str += comn_count + " :" + "<input type='text' id='column_name" + comn_count + "' class='column_name'><select id = 'select_datatype"+ select_comncnt +"' class='select_datatype'>"
                  + "<option value='NUMBER'>NUMBER</option> <option value='VARCHAR2'>VARCHAR2</option></select>"
                  + "<input type='hidden' id='direct_column" + dicomn_cnt + "'></input>";
   // 추가할 폼(에 들어갈 HTML)
   var addedComnDiv = document.createElement("div"); // 폼 생성
   addedComnDiv.id = "added_column" + comn_count; // 폼 Div에 ID 부여 (삭제를 위해)
   addedComnDiv.innerHTML = str; // 폼 Div안에 HTML삽입
   addedComnFormDiv.appendChild(addedComnDiv); // 삽입할 DIV에 생성한 폼 삽입
   
   $('<option value="직접입력">직접입력</option>').appendTo('#select_datatype' + select_comncnt);
   
   comn_count++;
   select_comncnt++;
   dicomn_cnt++;
}

/**
 * value form을 하나 감소시켜주는 함수
 */
function DelColumnForm() {
   var addedComnFormDiv = document.getElementById("tableDiv");
   
   if (comn_count > 1) { // 현재 폼이 두개 이상이면
      var addedComnDiv = document.getElementById("added_column" + (--comn_count));
      --select_comncnt;
      --dicomn_cnt;
      // 마지막으로 생성된 폼의 ID를 통해 Div객체를 가져옴
      addedComnFormDiv.removeChild(addedComnDiv); // 폼 삭제 
   }
}

/**
 * value form을 하나빼고 모두 제거 하는 함수
 */
function DelColumnAllForm()
{
   var addedComnFormDiv = document.getElementById("tableDiv");
   while(comn_count > 1)
   {
      if (comn_count > 1) { // 현재 폼이 두개 이상이면
      var addedComnDiv = document.getElementById("added_column" + (--comn_count));
      --select_comncnt;
      --dicomn_cnt;
      // 마지막으로 생성된 폼의 ID를 통해 Div객체를 가져옴
      addedComnFormDiv.removeChild(addedComnDiv); // 폼 삭제 
      } 
   }
}

/**
 * side에 list들을 전부 띄워주는 함수. (실행하면 list들을 삭제하고 다시 그려준다.)
 */
 function DB_List_View(){
	   
	   $('#tablelist').empty();
	   
	   for(var i=0;i<tableList.length;i++){
	      $('<div style=" width:120px;float:left; margin-left:20px; margin-top:5px">'
	+'<label value="' + tableList[i].tablename + '">' + tableList[i].tablename + '</label>').appendTo('#tablelist');
	      $('<div style="float:left; margin-bottom:10px;margin-left:40px">'
	+'<button class="btn btn-primary" onclick="DBList_Modify('+"\'" + tableList[i].tablename +"\'" +')">수정</button>').appendTo('#tablelist');
	      $('<div style="margin-bottom:10px">'
	+'<button class="btn btn-danger" onclick="DBList_Delete('+"\'" + tableList[i].tablename +"\'" +')">삭제</button></br>').appendTo('#tablelist');
	   }
	}
/**
 * form을 초기화 해주는 함수.
 * */
function FormDBInit(){
   
   // 폼의 값들을 초기화
   document.getElementById("tablename").value = "";
   document.getElementById("column_name0").value = "";
   document.getElementById("select_datatype0").value = "NUMBER";
   document.getElementById("direct_column0").value = "";
   document.getElementById("direct_column0").type = "hidden";
   document.getElementById("connect_dao").value = "init";
   // 폼 초기화
   DelColumnAllForm();
}

/* 여기까지 */



/* DB draw.js */
/**
 * 그림을 그려주는 함수들을 모아 놓은 js file.
 * table을 그리기 위한 함수
 */
function DrawTable(t_length) {

	context2.font = '12pt Calibri';
   
   // table의 크기에 맞추어서 사각형을 그려줌.
   context2.strokeRect(db_xpos, db_ypos, base_db_xpos + 4*(t_length), base_db_ypos + 20*(tname_num + comn_num));
   
   // table의 이름을 그려줌.
   context2.fillText(draw_tableName, db_xpos + 10, db_ypos + 15 * tname_num);
   
   // column을 그려줌.
   for (var i=0; i<comn_num; i++) {
      if(i == 0){
         if(draw_columnName[i] != "" && draw_dataType[i] != "직접입력"){
            context2.fillText(draw_dataType[i] + " " + draw_columnName[i] + " " + "(PK)", db_xpos+10, db_ypos+20 * tname_num + 15*(i+1));
         }else if(draw_columnName[i] != "" && draw_dataType[i] == "직접입력"){
            context2.fillText(draw_direct_type[i] + " " + draw_columnName[i], db_xpos+10, db_ypos+20 * tname_num + 15*(i+1));
         }
      }else{
         if(draw_columnName[i] != "" && draw_dataType[i] != "직접입력"){
            context2.fillText(draw_dataType[i] + " " + draw_columnName[i], db_xpos+10, db_ypos+20 * tname_num + 15*(i+1));
         }else if(draw_columnName[i] != "" && draw_dataType[i] == "직접입력"){
            context2.fillText(draw_direct_type[i] + " " + draw_columnName[i], db_xpos+10, db_ypos+20 * tname_num + 15*(i+1));
         }
      }
      
   }
   
   DrawDBLine();
}

/**
 * table의 이름과 칼럼명의 영역을 구별하기 위한 선을 그려주는 함수.
 */
function DrawDBLine() {
   context2.beginPath();
   context2.moveTo(db_xpos, db_ypos + 20 * tname_num);
   context2.lineTo(db_width, db_ypos + 20 * tname_num);
   context2.stroke();
}

/**
 * table의 좌표를 이어주기 위해 좌표를 계산하는 함수. ( list에 저장하기 전에 DrawTable()를 사용하기 전에 사용.)
 */
function DB_Connect_SavePoint(t_length,colnum){
	db_width = db_xpos + base_db_xpos  + 4*(t_length);
	db_height = db_ypos + base_db_ypos;
	
	end_db_xpos = db_width;
	end_db_ypos = db_height + 20*(1 + colnum);
}

/**
 * canvas의 내용을 전부 지움.
 */
function DB_Erase_Canvas(){
   context2.clearRect(0,0,1600,900);   
}

/**
 * list의 모든 클래스들을 그려주는 함수.
 */
function DB_Draw_AllList(){
   DB_Erase_Canvas();
   
   context2.beginPath();
   
   for(var i=0;i<tableList.length;i++){
      
      draw_tableName = tableList[i].tablename;
      
      comn_num = tableList[i].columnname.length;
      
      draw_columnName = tableList[i].columnname;
      draw_dataType = tableList[i].datatype;
      draw_direct_type = tableList[i].directtype;
      
      connecttable = tableList[i].conntablename;
      
      db_xpos = tableList[i].start_point_dbx;
      db_ypos = tableList[i].start_point_dby;
      
      /* test4 : 민섭*/
		var v_length = array_Compare(draw_columnName);
		var sv_length = array_Compare2(draw_dataType,draw_direct_type);
		   
	 	var c_length = Length_Compare(draw_tableName.length, v_length + sv_length,0);
      
      DB_Connect_SavePoint(c_length,comn_num);
	  DrawTable(c_length);
      
      DrawDBInit();
   }
   
   context2.rect(0, 0, 1600, 900);
   context2.stroke();
   context2.closePath();
   
}


/**
 * 변수들을 초기화 해주는 함수.
 */
function DrawDBInit(){
   db_xpos = 0;
   db_ypos = 0;
   tname_num = 1;
   comn_num = 1;
   end_db_xpos = 0;
   end_db_ypos = 0;
    
   db_width = 0;
   db_height = 0;
   
   draw_tableName = "";
   draw_columnName = [];
   draw_dataType = [];
   draw_direct_type = [];
   draw_conn_dao="";
}
/* 여기까지 */


        

/* DB mouse_event.js  */
/**
 * canvas를 움직일 떄 사용할 때 움직일 class를 찾을 함수
 */
function DBMoveRectangle(x,y){
   // tableList에서 움직일 class를 찾을 때...
   for (var i = 0;i < tableList.length;i++) {
      var r = tableList[i];
      if (x > r.start_point_dbx && x < r.end_point_dbx && y > r.start_point_dby && y < r.end_point_dby) {
         move_table = true;
         table_moving = i;
         break;
      }else{
         move_table = false;
      }
   }
   
   if(move_table == false){
      table_moving = -1;
   }
}

function DBMouseEventInit(){
   move_table = false;
   table_moving = -1;
}
/* 여기까지 */



//table 그려주기
     socket.on('tb_line', function(data){
	
		tableList[table_cnt] = data.table;	
		table_cnt++;
	
	
	
	
        //context.strokeStyle = data.color;
	context2.beginPath();
            
	DB_Draw_AllList();
	
	
	context2.stroke();

	DB_List_View();
	
	DB_All_Init();

    });


		//move한 캔버스 그려주기
     socket.on('move_tb_line', function(data){

	
	
		var r=tableList[data.mv_idx] ;
		r.start_point_dbx = data.start_x;
		r.start_point_dby = data.start_y;
		r.end_point_dbx = data.end_x;
		r.end_point_dby = data.end_y;

					
		


	
        //context.strokeStyle = data.color;
	context2.beginPath();
            
	DB_Draw_AllList();
	
	
	context2.stroke();

	DB_All_Init();

    });

	//modify한 table 그려주기
     socket.on('mod_tb_line', function(data){

	
		tableList[data.m_idx]=data.table;

	
        //context.strokeStyle = data.color;
	context2.beginPath();
            
	DB_Draw_AllList();
	
	
	context2.stroke();

	DB_List_View();
	DB_All_Init();

    });


	//delete한 table 그려주기
     socket.on('del_tb_line', function(data){

	
	tableList.splice(data.d_idx,1);
      if(table_cnt > 0){
         table_cnt--;
      }

	
        //context.strokeStyle = data.color;
	context2.beginPath();
    DB_Erase_Canvas();        
	DB_Draw_AllList();
	
	
	context2.stroke();

	DB_List_View();
	DB_All_Init();

    });
</script>

<script type="text/javascript">
$(document).ready(function(){
    
    $('#template').on('hidden.bs.modal', function () {//모달창이 close되었을때 발생하는 이벤트
	});
    
    $('#select_template').click(function(){
        $("#template").modal();
    });
	
	$('.t_img').on('click',function(){
		$(this).css('border','0px solid #d9534f');
		$(this).css('box-shadow', '2px 2px 5px 0px #d9534f');		
		$(this).css('opacity', '0.4');
		$(this).css('width', '100%');
		
		$('.t_img').not(this).css('border', '0px solid #333');
		$('.t_img').not(this).css('box-shadow', '2px 2px 5px 0px #333');
		$('.t_img').not(this).css('opacity', '1');
		$('.t_img').not(this).css('width', '90%');
		
		select_img = $(this).attr('alt');
	});
	$('.t_img').on('dblclick', function(){
		if($(this).css('position') == 'relative'){
			var img = $(this).attr('alt');
			$('#temp_t_img').append('<img class="big_img" style="width:200%;height:auto;z-index:2;" src="/resources/res/images/'+img+'_1.PNG">');
		}		
	});
	$(document).on('click',".big_img", function(){
		$('#temp_t_img').html("");
	});
	$(document).on('click',".modal-dialog", function(){
		$('#temp_t_img').html("");
	});
	
 	$('.t_img').mouseenter(function(){
 		if(select_img != $(this).attr('alt')){
 			$(this).css('border','0px solid #4285f4');
 			$(this).css('box-shadow', '2px 2px 5px 0px #4285f4');
 			$(this).css('width','100%');
		}
	});
	$('.t_img').mouseleave(function(){
		if(select_img != $(this).attr('alt')){
			$(this).css('border','0px solid #333');
			$(this).css('box-shadow', '2px 2px 5px 0px #333');
			$(this).css('width','90%');
		}
	});
	
});
/* test7 : template로 안바꿨던것들 수정 (replaceAll로 바꾸면 2개인가 바뀔거) / 취소버튼 눌렀을때 select_img 1(기본)으로 바꿔주고 모든 템플릿 이미지들 css 기본으로 변경 */
function template_cancel(){
	select_img = '1';
	$('.t_img').css('border', '0px solid #333');
	$('.t_img').css('box-shadow', '2px 2px 5px 0px #333');
	$('.t_img').css('opacity', '1');
	$('.t_img').css('width', '90%');
}
</script>